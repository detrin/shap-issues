{
  "url": "https://api.github.com/repos/shap/shap/issues/1846",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1846/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1846/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1846/events",
  "html_url": "https://github.com/shap/shap/issues/1846",
  "id": 820679433,
  "node_id": "MDU6SXNzdWU4MjA2Nzk0MzM=",
  "number": 1846,
  "title": "SHAP to explain group fairness disparity",
  "user": {
    "login": "arinath",
    "id": 78103527,
    "node_id": "MDQ6VXNlcjc4MTAzNTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/78103527?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arinath",
    "html_url": "https://github.com/arinath",
    "followers_url": "https://api.github.com/users/arinath/followers",
    "following_url": "https://api.github.com/users/arinath/following{/other_user}",
    "gists_url": "https://api.github.com/users/arinath/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arinath/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arinath/subscriptions",
    "organizations_url": "https://api.github.com/users/arinath/orgs",
    "repos_url": "https://api.github.com/users/arinath/repos",
    "events_url": "https://api.github.com/users/arinath/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arinath/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-03-03T04:24:09Z",
  "updated_at": "2021-03-23T14:55:08Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi Everyone,\r\n\r\n**Sorry if this is too verbose and confusing...**\r\n\r\nWe are trying to compute the group fairness disparity at two levels in the UCI adult income dataset conditioned on the protected attribute **gender**.\r\n1- Overall disparity between the outcomes for female - male\r\n2- Individual contributions of features towards the overall disparity in 1 between the outcomes for female - male\r\n\r\nFor 1, We are using the Equality of Opportunity metric. Not sure if we're doing it right. We are calculating the TPR for female and male subgroups using the SHAP values for the gender feature given the prediction was true and the ground truth (target label) was true for the respective subgroups.\r\n\r\nSum of (TPR) shap values for female: 0.8433953656391471\r\nSum of (TPR) shap values for male: 0.7795657153434582\r\nOverall Equality of Opportunity Difference by protected attribute:\r\nSum of (TPR) shap values for female - Sum of (TPR) shap values for male = 0.06382965029568888\r\n\r\nFor 2, also using the Equality of Opportunity metric. We are calculating the TPR **contributions** for every feature for the female and male subgroups using the SHAP values for the gender feature given the prediction was true and the ground truth (target label) was true for the respective subgroups.\r\n\r\nWe are getting TPRs for some of the features > 1. Which is expected per our approach as there are negative and positive values that when summed might result in smaller denominator. \r\n\r\nSum of shap values True Positives for female and feature relationship=Not-in-family: 0.4512588840000001\r\nSum of shap values True Positives for male and feature relationship=Not-in-family: 0.5057941069999995\r\nSum of shap values Positives for female and feature relationship=Not-in-family: 0.014189712000000063\r\nSum of shap values Positives for male and feature relationship=Not-in-family: -5.1852701539999995\r\nTPR for female relationship=Not-in-family 31.801835301519727\r\nTPR for male relationship=Not-in-family -0.09754440790511598\r\n \r\nThe negative value is concerning, although we understand these are not really TPR but contributions of the feature towards the overall TPR by feature (calculated just as we would calculate TPR). I would appreciate if someone could validate our approach.\r\n\r\nThanks very much!",
  "closed_by": {
    "login": "arinath",
    "id": 78103527,
    "node_id": "MDQ6VXNlcjc4MTAzNTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/78103527?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arinath",
    "html_url": "https://github.com/arinath",
    "followers_url": "https://api.github.com/users/arinath/followers",
    "following_url": "https://api.github.com/users/arinath/following{/other_user}",
    "gists_url": "https://api.github.com/users/arinath/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arinath/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arinath/subscriptions",
    "organizations_url": "https://api.github.com/users/arinath/orgs",
    "repos_url": "https://api.github.com/users/arinath/repos",
    "events_url": "https://api.github.com/users/arinath/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arinath/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1846/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1846/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
