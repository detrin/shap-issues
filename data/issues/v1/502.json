{
  "url": "https://api.github.com/repos/shap/shap/issues/502",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/502/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/502/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/502/events",
  "html_url": "https://github.com/shap/shap/issues/502",
  "id": 423739053,
  "node_id": "MDU6SXNzdWU0MjM3MzkwNTM=",
  "number": 502,
  "title": "tensorflow:Cannot use 'gradients_2/f_count_1' as input to 'gradients_2/f_count' because they are in different while loops",
  "user": {
    "login": "galenwilkerson",
    "id": 208536,
    "node_id": "MDQ6VXNlcjIwODUzNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/208536?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/galenwilkerson",
    "html_url": "https://github.com/galenwilkerson",
    "followers_url": "https://api.github.com/users/galenwilkerson/followers",
    "following_url": "https://api.github.com/users/galenwilkerson/following{/other_user}",
    "gists_url": "https://api.github.com/users/galenwilkerson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/galenwilkerson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/galenwilkerson/subscriptions",
    "organizations_url": "https://api.github.com/users/galenwilkerson/orgs",
    "repos_url": "https://api.github.com/users/galenwilkerson/repos",
    "events_url": "https://api.github.com/users/galenwilkerson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/galenwilkerson/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-03-21T13:50:28Z",
  "updated_at": "2023-08-26T08:37:53Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, I'm getting a strange error when I try to use shap on this particular keras LSTM model (with tensorflow backend).  Thanks for suggestions.\r\n\r\nSome environment info:  \r\npython 3.6\r\n\r\n`tensorflow.__version__`\r\n> 1.12.0\r\n\r\n`keras.__version__`\r\n> 2.2.4\r\n\r\nError:\r\n\r\n'INFO:tensorflow:Cannot use 'gradients_2/f_count_1' as input to 'gradients_2/f_count' because they are in different while loops.\r\n\r\ngradients_2/f_count_1 while context: lstm_4/while/while_context\r\ngradients_2/f_count while context: gradients_1/lstm_3/while/while_context\r\n\r\nTraceback for gradients_2/f_count_1:\r\n  File \"/home/galen/anaconda3/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/home/galen/anaconda3/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 486, in start\r\n    self.io_loop.start()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/platform/asyncio.py\", line 127, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/base_events.py\", line 422, in run_forever\r\n    self._run_once()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/base_events.py\", line 1432, in _run_once\r\n    handle._run()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/platform/asyncio.py\", line 117, in _handle_events\r\n    handler_func(fileobj, events)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n    self._handle_recv()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2909, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-27-f764a88bbadf>\", line 1, in <module>\r\n    shap_values = explainer.shap_values(X)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/__init__.py\", line 119, in shap_values\r\n    return self.explainer.shap_values(X, ranked_outputs, output_rank_order)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py\", line 262, in shap_values\r\n    sample_phis = self.run(self.phi_symbolic(feature_ind), self.model_inputs, joint_input)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py\", line 202, in phi_symbolic\r\n    self.phi_symbolics[i] = tf.gradients(out, self.model_inputs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 630, in gradients\r\n    gate_gradients, aggregation_method, stop_gradients)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 698, in _GradientsHelper\r\n    to_ops, from_ops, colocate_gradients_with_ops, func_graphs, xs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 194, in _PendingCount\r\n    between_op_list, between_ops, colocate_gradients_with_ops)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1445, in MaybeCreateControlFlowState\r\n    loop_state.AddWhileContext(op, between_op_list, between_ops)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1257, in AddWhileContext\r\n    grad_state = GradLoopState(forward_ctxt, outer_grad_state)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 834, in __init__\r\n    cnt, forward_index = forward_ctxt.AddForwardLoopCounter(outer_grad_state)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2583, in AddForwardLoopCounter\r\n    name=\"f_count\")\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 258, in _Enter\r\n    data, frame_name, is_constant, parallel_iterations, name=name)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_control_flow_ops.py\", line 179, in enter\r\n    parallel_iterations=parallel_iterations, name=name)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nTraceback for gradients_2/f_count:\r\n  File \"/home/galen/anaconda3/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/home/galen/anaconda3/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 486, in start\r\n    self.io_loop.start()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/platform/asyncio.py\", line 127, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/base_events.py\", line 422, in run_forever\r\n    self._run_once()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/base_events.py\", line 1432, in _run_once\r\n    handle._run()\r\n  File \"/home/galen/anaconda3/lib/python3.6/asyncio/events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/platform/asyncio.py\", line 117, in _handle_events\r\n    handler_func(fileobj, events)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n    self._handle_recv()\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2909, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-27-f764a88bbadf>\", line 1, in <module>\r\n    shap_values = explainer.shap_values(X)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/__init__.py\", line 119, in shap_values\r\n    return self.explainer.shap_values(X, ranked_outputs, output_rank_order)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py\", line 262, in shap_values\r\n    sample_phis = self.run(self.phi_symbolic(feature_ind), self.model_inputs, joint_input)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py\", line 202, in phi_symbolic\r\n    self.phi_symbolics[i] = tf.gradients(out, self.model_inputs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 630, in gradients\r\n    gate_gradients, aggregation_method, stop_gradients)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 698, in _GradientsHelper\r\n    to_ops, from_ops, colocate_gradients_with_ops, func_graphs, xs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py\", line 194, in _PendingCount\r\n    between_op_list, between_ops, colocate_gradients_with_ops)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1445, in MaybeCreateControlFlowState\r\n    loop_state.AddWhileContext(op, between_op_list, between_ops)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1257, in AddWhileContext\r\n    grad_state = GradLoopState(forward_ctxt, outer_grad_state)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 834, in __init__\r\n    cnt, forward_index = forward_ctxt.AddForwardLoopCounter(outer_grad_state)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2569, in AddForwardLoopCounter\r\n    n = constant_op.constant(0, name=\"f_count\")\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/constant_op.py\", line 214, in constant\r\n    name=name).outputs[0]\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/galen/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-27-f764a88bbadf> in <module>()\r\n----> 1 shap_values = explainer.shap_values(X)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/__init__.py in shap_values(self, X, ranked_outputs, output_rank_order)\r\n    117         were chosen as \"top\".\r\n    118         \"\"\"\r\n--> 119         return self.explainer.shap_values(X, ranked_outputs, output_rank_order)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py in shap_values(self, X, ranked_outputs, output_rank_order)\r\n    260                 # run attribution computation graph\r\n    261                 feature_ind = model_output_ranks[j,i]\r\n--> 262                 sample_phis = self.run(self.phi_symbolic(feature_ind), self.model_inputs, joint_input)\r\n    263 \r\n    264                 # assign the attributions to the right part of the output arrays\r\n\r\n~/anaconda3/lib/python3.6/site-packages/shap/explainers/deep/deep_tf.py in phi_symbolic(self, i)\r\n    200             try:\r\n    201                 out = self.model_output[:,i] if self.multi_output else self.model_output\r\n--> 202                 self.phi_symbolics[i] = tf.gradients(out, self.model_inputs)\r\n    203 \r\n    204             finally:\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py in gradients(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients)\r\n    628   with ops.get_default_graph()._mutation_lock():  # pylint: disable=protected-access\r\n    629     return _GradientsHelper(ys, xs, grad_ys, name, colocate_gradients_with_ops,\r\n--> 630                             gate_gradients, aggregation_method, stop_gradients)\r\n    631 \r\n    632 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py in _GradientsHelper(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients, src_graph)\r\n    696     stop_gradient_ops = [t.op for t in stop_gradients]\r\n    697     reachable_to_ops, pending_count, loop_state = _PendingCount(\r\n--> 698         to_ops, from_ops, colocate_gradients_with_ops, func_graphs, xs)\r\n    699 \r\n    700     # Iterate over the collected ops.\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py in _PendingCount(to_ops, from_ops, colocate_gradients_with_ops, func_graphs, xs)\r\n    192   # 'loop_state' is None if there are no while loops.\r\n    193   loop_state = control_flow_ops.MaybeCreateControlFlowState(\r\n--> 194       between_op_list, between_ops, colocate_gradients_with_ops)\r\n    195 \r\n    196   # Initialize pending count for between ops.\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in MaybeCreateControlFlowState(between_op_list, between_ops, colocate_gradients_with_ops)\r\n   1443           loop_state.AddWhileContext(op, between_op_list, between_ops)\r\n   1444       else:\r\n-> 1445         loop_state.AddWhileContext(op, between_op_list, between_ops)\r\n   1446   return loop_state\r\n   1447 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in AddWhileContext(self, op, between_op_list, between_ops)\r\n   1255       if outer_forward_ctxt:\r\n   1256         outer_grad_state = self._map.get(outer_forward_ctxt)\r\n-> 1257       grad_state = GradLoopState(forward_ctxt, outer_grad_state)\r\n   1258       self._map[forward_ctxt] = grad_state\r\n   1259 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in __init__(self, forward_ctxt, outer_grad_state)\r\n    832       if outer_forward_ctxt:\r\n    833         outer_forward_ctxt.Enter()\r\n--> 834       cnt, forward_index = forward_ctxt.AddForwardLoopCounter(outer_grad_state)\r\n    835       if outer_forward_ctxt:\r\n    836         outer_forward_ctxt.Exit()\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in AddForwardLoopCounter(self, outer_grad_state)\r\n   2581         is_constant=False,\r\n   2582         parallel_iterations=self._parallel_iterations,\r\n-> 2583         name=\"f_count\")\r\n   2584     self.loop_enters.append(enter_n)\r\n   2585 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in _Enter(data, frame_name, is_constant, parallel_iterations, use_ref, use_input_shape, name)\r\n    256     else:\r\n    257       result = gen_control_flow_ops.enter(\r\n--> 258           data, frame_name, is_constant, parallel_iterations, name=name)\r\n    259     if use_input_shape:\r\n    260       result.set_shape(data.get_shape())\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_control_flow_ops.py in enter(data, frame_name, is_constant, parallel_iterations, name)\r\n    177     _, _, _op = _op_def_lib._apply_op_helper(\r\n    178         \"Enter\", data=data, frame_name=frame_name, is_constant=is_constant,\r\n--> 179         parallel_iterations=parallel_iterations, name=name)\r\n    180     _result = _op.outputs[:]\r\n    181     _inputs_flat = _op.inputs\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py in _apply_op_helper(self, op_type_name, name, **keywords)\r\n    785         op = g.create_op(op_type_name, inputs, output_types, name=scope,\r\n    786                          input_types=input_types, attrs=attr_protos,\r\n--> 787                          op_def=op_def)\r\n    788       return output_structure, op_def.is_stateful, op\r\n    789 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py in new_func(*args, **kwargs)\r\n    486                 'in a future version' if date is None else ('after %s' % date),\r\n    487                 instructions)\r\n--> 488       return func(*args, **kwargs)\r\n    489     return tf_decorator.make_decorator(func, new_func, 'deprecated',\r\n    490                                        _add_deprecated_arg_notice_to_docstring(\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in create_op(***failed resolving arguments***)\r\n   3272           input_types=input_types,\r\n   3273           original_op=self._default_original_op,\r\n-> 3274           op_def=op_def)\r\n   3275       self._create_op_helper(ret, compute_device=compute_device)\r\n   3276     return ret\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in __init__(self, node_def, g, inputs, output_types, control_inputs, input_types, original_op, op_def)\r\n   1805 \r\n   1806     if not c_op:\r\n-> 1807       self._control_flow_post_processing()\r\n   1808 \r\n   1809   def _control_flow_post_processing(self):\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in _control_flow_post_processing(self)\r\n   1814     \"\"\"\r\n   1815     for input_tensor in self.inputs:\r\n-> 1816       control_flow_util.CheckInputFromValidContext(self, input_tensor.op)\r\n   1817     if self._control_flow_context is not None:\r\n   1818       self._control_flow_context.AddOp(self)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_util.py in CheckInputFromValidContext(op, input_op)\r\n    320         input_op.name, \"\".join(traceback.format_list(input_op.traceback)))\r\n    321     logging.info(log_msg)\r\n--> 322     raise ValueError(error_msg + \" See info log for more details.\")\r\n\r\nValueError: Cannot use 'gradients_2/f_count_1' as input to 'gradients_2/f_count' because they are in different while loops. See info log for more details.\r\n\r\n'",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/502/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/502/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
