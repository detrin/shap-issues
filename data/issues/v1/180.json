{
  "url": "https://api.github.com/repos/shap/shap/issues/180",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/180/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/180/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/180/events",
  "html_url": "https://github.com/shap/shap/issues/180",
  "id": 344349952,
  "node_id": "MDU6SXNzdWUzNDQzNDk5NTI=",
  "number": 180,
  "title": "Weird KernelExplainer behavior on Image Classification Network",
  "user": {
    "login": "NTNguyen13",
    "id": 39985901,
    "node_id": "MDQ6VXNlcjM5OTg1OTAx",
    "avatar_url": "https://avatars.githubusercontent.com/u/39985901?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NTNguyen13",
    "html_url": "https://github.com/NTNguyen13",
    "followers_url": "https://api.github.com/users/NTNguyen13/followers",
    "following_url": "https://api.github.com/users/NTNguyen13/following{/other_user}",
    "gists_url": "https://api.github.com/users/NTNguyen13/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NTNguyen13/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NTNguyen13/subscriptions",
    "organizations_url": "https://api.github.com/users/NTNguyen13/orgs",
    "repos_url": "https://api.github.com/users/NTNguyen13/repos",
    "events_url": "https://api.github.com/users/NTNguyen13/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NTNguyen13/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-07-25T08:49:05Z",
  "updated_at": "2022-01-18T10:00:34Z",
  "closed_at": "2022-01-18T10:00:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi,\r\n\r\nI'm using SHAP to explain the prediction of an Image Classification Network. I follow[ this notebook](https://github.com/slundberg/shap/blob/master/notebooks/kernel_explainer/ImageNet%20VGG16%20Model%20with%20Keras.ipynb).\r\n\r\nHowever, when I tried to use it to explain some output, the SHAP values return on the superpixel is sometimes weird, it can either be empty or the top prediction have less SHAP values than the second or the third. In a lot of cases, the area of the image with high SHAP values even falls on the empty region of the image. \r\n\r\nExample:\r\nTop prediction has less empty value:\r\n![a549--eztt0lbzsdi6wvpt3mjbkpqakuxge0fa_20180329_cell6_shap](https://user-images.githubusercontent.com/39985901/43189717-3591cf08-9032-11e8-892b-0839d5f6fd69.png)\r\nMost of the high-SHAP-value of top prediction is on empty region, contrast with the third one\r\n![mcf7--xbfoes6kdjggrvcnuiv49wzemppldm5j_20180329_cell17_shap](https://user-images.githubusercontent.com/39985901/43189951-db9bfdf6-9032-11e8-8408-708fa2f9048e.png)\r\n\r\nCan you give me an idea of how this phenomenon happen? Thank you\r\n\r\nEdit 1: One more thing: about the \r\n```\r\nexplainer = shap.KernelExplainer(f, np.zeros((1, 50)))\r\nshap_values = explainer.shap_values(np.ones((1, 50)), nsamples=1000) \r\n```\r\nis those functions needed to be updated for every images or it will run for all the dataset specified in `nsamples`? I'm going to apply a forloop to explain multiple images each iteration",
  "closed_by": {
    "login": "NTNguyen13",
    "id": 39985901,
    "node_id": "MDQ6VXNlcjM5OTg1OTAx",
    "avatar_url": "https://avatars.githubusercontent.com/u/39985901?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NTNguyen13",
    "html_url": "https://github.com/NTNguyen13",
    "followers_url": "https://api.github.com/users/NTNguyen13/followers",
    "following_url": "https://api.github.com/users/NTNguyen13/following{/other_user}",
    "gists_url": "https://api.github.com/users/NTNguyen13/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NTNguyen13/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NTNguyen13/subscriptions",
    "organizations_url": "https://api.github.com/users/NTNguyen13/orgs",
    "repos_url": "https://api.github.com/users/NTNguyen13/repos",
    "events_url": "https://api.github.com/users/NTNguyen13/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NTNguyen13/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/180/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/180/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
