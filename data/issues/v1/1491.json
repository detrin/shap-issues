{
  "url": "https://api.github.com/repos/shap/shap/issues/1491",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1491/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1491/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1491/events",
  "html_url": "https://github.com/shap/shap/issues/1491",
  "id": 713876428,
  "node_id": "MDU6SXNzdWU3MTM4NzY0Mjg=",
  "number": 1491,
  "title": "Interpretation for drastic difference between shap logloss, probability and other importance metrics",
  "user": {
    "login": "hoangthienan95",
    "id": 25307953,
    "node_id": "MDQ6VXNlcjI1MzA3OTUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/25307953?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hoangthienan95",
    "html_url": "https://github.com/hoangthienan95",
    "followers_url": "https://api.github.com/users/hoangthienan95/followers",
    "following_url": "https://api.github.com/users/hoangthienan95/following{/other_user}",
    "gists_url": "https://api.github.com/users/hoangthienan95/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hoangthienan95/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hoangthienan95/subscriptions",
    "organizations_url": "https://api.github.com/users/hoangthienan95/orgs",
    "repos_url": "https://api.github.com/users/hoangthienan95/repos",
    "events_url": "https://api.github.com/users/hoangthienan95/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hoangthienan95/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2020-10-02T20:12:55Z",
  "updated_at": "2020-10-02T20:21:05Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "My data have 31 days. I fit a Random Forest model on records of each day (31 models total), get the SHAP value for each feature, and view them on a heatmap. I also included permutation importance and Random Forest's native importance. **The importance was calculated only on the train set `mean(|SHAP day x records|)`** since I'm only interested in comparing the model's attribution for the single day it was trained on.\r\n\r\nWhat I did:\r\n```python\r\n# compute SHAP values log loss\r\nexplainer = shap.TreeExplainer(model, X_time_restricted, feature_dependence =\"interventional\", model_output=\"log_loss\")\r\nshap_values = explainer.shap_values(X_time_restricted, y_time_restricted.astype(int))\r\n\r\n# compute SHAP values probability\r\nexplainer_proba = shap.TreeExplainer(model, X_time_restricted, feature_dependence =\"interventional\", model_output=\"probability\")\r\nshap_values_proba = explainer_proba.shap_values(X_time_restricted, y_time_restricted.astype(int))\r\n\r\n# compute SHAP values\r\nexplainer_raw = shap.TreeExplainer(model, X_time_restricted, feature_dependence =\"interventional\", model_output=\"raw\")\r\nshap_values_raw = explainer.shap_values(X_time_restricted, y_time_restricted.astype(int))\r\n```\r\nHere is my data. x axis is the day whose records the model was trained on, the rows are the features.\r\n\r\nContinuous feature importances:\r\n![image](https://user-images.githubusercontent.com/25307953/94965709-f5943300-04c9-11eb-8b8d-b7fbe5a1009f.png)\r\n\r\nBinarized to non-zero and zero:\r\n![image](https://user-images.githubusercontent.com/25307953/94965751-09d83000-04ca-11eb-9e0e-7ff3f570a3ad.png)\r\n\r\n Reading the documentation [here](https://shap.readthedocs.io/en/latest/example_notebooks/kernel_explainer/Squashing%20Effect.html), I understand that different model output can vary in magnitude and range depending on what you care about, information or probability change or loss contribution. \r\n\r\nHowever, I was expecting that if a feature has non-zero importance using one metric, then it would also have non-zero importance using another metric. All 4 metrics of importance are extremely different. Am I missing something?",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1491/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1491/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
