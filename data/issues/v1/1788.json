{
  "url": "https://api.github.com/repos/shap/shap/issues/1788",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1788/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1788/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1788/events",
  "html_url": "https://github.com/shap/shap/issues/1788",
  "id": 795554897,
  "node_id": "MDU6SXNzdWU3OTU1NTQ4OTc=",
  "number": 1788,
  "title": "[Question] how to get meaningful expected value with down-sampled dataset",
  "user": {
    "login": "songqiang",
    "id": 348179,
    "node_id": "MDQ6VXNlcjM0ODE3OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/348179?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/songqiang",
    "html_url": "https://github.com/songqiang",
    "followers_url": "https://api.github.com/users/songqiang/followers",
    "following_url": "https://api.github.com/users/songqiang/following{/other_user}",
    "gists_url": "https://api.github.com/users/songqiang/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/songqiang/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/songqiang/subscriptions",
    "organizations_url": "https://api.github.com/users/songqiang/orgs",
    "repos_url": "https://api.github.com/users/songqiang/repos",
    "events_url": "https://api.github.com/users/songqiang/events{/privacy}",
    "received_events_url": "https://api.github.com/users/songqiang/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-01-28T00:16:03Z",
  "updated_at": "2022-03-10T11:47:26Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello, \r\n\r\nI have a binary classification problem with significant class imbalance (for example, positive case to negative case is 1:1000). During model training, I down-sampled the negative cases to get a more balanced training data (positive to negative is 1:10). \r\n\r\nI use xgboost as my model backend and TreeExplainer as the explainer. If I use the \"tree_path_dependent\" feature_perturbation method, the expected value is something close to 0.1 in probability space and -2.19 in the logit space. If I pass in the down-sampled training data as my background dataset, the expected value is also around 0.1. However when presenting to the business users, it will be more intuitive to show the expected value around 0.001.\r\n\r\nI am thinking about a few options:\r\n\r\n1. is it possible to set the desired expected_value as an option? I can change the expected in the force_plot, but it also shift the model output accordingly, which is undesirable.\r\n\r\n2. is it possible to pass a weight dataset when passing the background dataset? I saw this issue https://github.com/slundberg/shap/issues/1328, but it seems not doable\r\n\r\n3. I pass a background dataset from the original population. But the problem is that the background data have to be more than 1000 samples to include one single positive sample, which makes the explaining process slow. In addition, the particular positive cases in the sampled data has significant impact on the calculated value.\r\n\r\nDo you have suggestions on how to achieve that?\r\n\r\nThanks!\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1788/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1788/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
