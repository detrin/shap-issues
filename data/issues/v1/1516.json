{
  "url": "https://api.github.com/repos/shap/shap/issues/1516",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1516/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1516/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1516/events",
  "html_url": "https://github.com/shap/shap/issues/1516",
  "id": 718833535,
  "node_id": "MDU6SXNzdWU3MTg4MzM1MzU=",
  "number": 1516,
  "title": "Can I use SHAP Values to Explain SHAP Values?",
  "user": {
    "login": "Olof-Hojvall",
    "id": 36272238,
    "node_id": "MDQ6VXNlcjM2MjcyMjM4",
    "avatar_url": "https://avatars.githubusercontent.com/u/36272238?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Olof-Hojvall",
    "html_url": "https://github.com/Olof-Hojvall",
    "followers_url": "https://api.github.com/users/Olof-Hojvall/followers",
    "following_url": "https://api.github.com/users/Olof-Hojvall/following{/other_user}",
    "gists_url": "https://api.github.com/users/Olof-Hojvall/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Olof-Hojvall/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Olof-Hojvall/subscriptions",
    "organizations_url": "https://api.github.com/users/Olof-Hojvall/orgs",
    "repos_url": "https://api.github.com/users/Olof-Hojvall/repos",
    "events_url": "https://api.github.com/users/Olof-Hojvall/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Olof-Hojvall/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2020-10-11T13:13:06Z",
  "updated_at": "2020-10-11T13:13:06Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I wonder about feasibility of using SHAP values to explain SHAP values. Instead of using interaction values, we create a model that aims to explain the SHAP values for a column, and evaluate that model with SHAP. I'm not actually sure why you would want to do it instead of interaction values, but calculations seem faster if we only care about interactions with a specific feature, and it may allow explaining more complex interactions. I tested it by replicating the NHANES interaction values example ([full notebook](https://gist.github.com/Olof-Hojvall/63bbbba5d8f0957b9eeba2ae7e3d347b)).\r\n```\r\n# We want to explain SHAP value for Age, so it's now the target variable\r\ny_shap_age = shap_values[:,X.columns.get_loc('Age')].values\r\nX_train, X_test, y_train, y_test = train_test_split(X, y_shap_age,\r\n                                                    test_size=0.2, random_state=8)\r\nage_train = xgboost.DMatrix(X_train, label=y_train)\r\nage_test = xgboost.DMatrix(X_test, label=y_test)\r\n\r\n# Same setup as the original model, except for the objective\r\nparams = {\r\n    \"eta\": 0.002,\r\n    \"max_depth\": 3,\r\n    \"subsample\": 0.5,\r\n    \"objective\":\"reg:pseudohubererror\",\r\n    \"eval_metric\": \"mae\"\r\n}\r\nmodel_shap = xgboost.train(params, age_train, 10000, evals = [(age_train, \"train\"), (age_test, \"test\")], verbose_eval=1000)\r\n\r\nage_shap_explainer = shap.TreeExplainer(model_shap)\r\nage_shap_values = age_shap_explainer.shap_values(X)\r\n```\r\n![image](https://user-images.githubusercontent.com/36272238/95679530-b6559880-0bd3-11eb-9e90-80a4f9612a13.png)\r\n\r\nFor the main effect, the two methods give very similar results. The left plot is copied from the NHANES interaction values notebook. The right plot is what I get from the model trained on Age SHAP values.\r\n\r\n![image](https://user-images.githubusercontent.com/36272238/95679542-c40b1e00-0bd3-11eb-943d-41082ee5bb37.png)\r\n\r\nFor the interactions of Age and Sex, the overall shapes have some similarities, but it's not as clear.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1516/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1516/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
