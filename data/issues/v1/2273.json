{
  "url": "https://api.github.com/repos/shap/shap/issues/2273",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/2273/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/2273/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/2273/events",
  "html_url": "https://github.com/shap/shap/issues/2273",
  "id": 1057359100,
  "node_id": "I_kwDOBHDcK84_BgT8",
  "number": 2273,
  "title": "ValueError: dependence_plot error for categorical variables with matplotlib >= 3.5.0",
  "user": {
    "login": "larpal",
    "id": 2567456,
    "node_id": "MDQ6VXNlcjI1Njc0NTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2567456?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/larpal",
    "html_url": "https://github.com/larpal",
    "followers_url": "https://api.github.com/users/larpal/followers",
    "following_url": "https://api.github.com/users/larpal/following{/other_user}",
    "gists_url": "https://api.github.com/users/larpal/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/larpal/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/larpal/subscriptions",
    "organizations_url": "https://api.github.com/users/larpal/orgs",
    "repos_url": "https://api.github.com/users/larpal/repos",
    "events_url": "https://api.github.com/users/larpal/events{/privacy}",
    "received_events_url": "https://api.github.com/users/larpal/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 21,
  "created_at": "2021-11-18T13:29:13Z",
  "updated_at": "2023-07-12T20:34:23Z",
  "closed_at": "2023-07-12T20:34:22Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Bug Summary**\r\nThe function `dependence_plot` throws a value error for interactions with categorical variables for matplotlib version 3.5.0. \r\nThe bug is caused since `matplotlib.pyplot.scatter` prohibits the use of the parameters `norm` and `vmin/vmax` at the same time which the `dependence_plot` does for categorical variables.\r\n\r\n**SHAP Version**\r\n0.40.0\r\n\r\n**Matplotlib Version**\r\n3.5.0\r\n\r\n**Python Version**\r\nPython 3.7.10\r\n\r\n**Code for Reproduction**\r\n\r\n```\r\nimport shap\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\n\r\nn_points = 100\r\n\r\n# create two float and one binary feature\r\nX = np.concatenate([np.random.rand(n_points,2), np.random.randn(n_points,1)>0], axis=1)\r\nshap_values = np.random.randn(*X.shape)\r\n\r\n# features 0 and 1 are both floats\r\nprint(\"numerical / numerical interaction:\")\r\nshap.dependence_plot(0,shap_values,X, interaction_index=1)\r\n\r\n# feature 2 is binary\r\nprint(\"numerical / binary interaction:\")\r\nshap.dependence_plot(0,shap_values,X, interaction_index=2)\r\n```\r\n**Outcome**\r\nnumerical / numerical interaction:\r\n![image](https://user-images.githubusercontent.com/2567456/142423331-3b517800-2c23-4d52-8af8-bf8a10e4ec81.png)\r\nnumerical / binary interaction:\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-44-ec650db72f40> in <module>\r\n      8 shap.dependence_plot(0,shap_values,X, interaction_index=1)\r\n      9 print(\"numerical / binary interaction\")\r\n---> 10 shap.dependence_plot(0,shap_values,X, interaction_index=2)\r\n\r\n/opt/conda/lib/python3.7/site-packages/shap/plots/dependence.py in dependence_plot(ind, shap_values, features, feature_names, display_features, interaction_index, color, axis_color, cmap, dot_size, x_jitter, alpha, title, xmin, xmax, ax, show)\r\n\r\n/opt/conda/lib/python3.7/site-packages/matplotlib/__init__.py in inner(ax, data, *args, **kwargs)\r\n   1410     def inner(ax, *args, data=None, **kwargs):\r\n   1411         if data is None:\r\n-> 1412             return func(ax, *map(sanitize_sequence, args), **kwargs)\r\n   1413 \r\n   1414         bound = new_sig.bind(ax, *args, **kwargs)\r\n\r\n/opt/conda/lib/python3.7/site-packages/matplotlib/axes/_axes.py in scatter(self, x, y, s, c, marker, cmap, norm, vmin, vmax, alpha, linewidths, edgecolors, plotnonfinite, **kwargs)\r\n   4426             collection.set_cmap(cmap)\r\n   4427             collection.set_norm(norm)\r\n-> 4428             collection._scale_norm(norm, vmin, vmax)\r\n   4429 \r\n   4430         # Classic mode only:\r\n\r\n/opt/conda/lib/python3.7/site-packages/matplotlib/cm.py in _scale_norm(self, norm, vmin, vmax)\r\n    379             if norm is not None:\r\n    380                 raise ValueError(\r\n--> 381                     \"Passing parameters norm and vmin/vmax simultaneously is \"\r\n    382                     \"not supported. Please pass vmin/vmax directly to the \"\r\n    383                     \"norm when creating it.\")\r\n\r\nValueError: Passing parameters norm and vmin/vmax simultaneously is not supported. Please pass vmin/vmax directly to the norm when creating it.\r\n```\r\n\r\n",
  "closed_by": {
    "login": "connortann",
    "id": 71127464,
    "node_id": "MDQ6VXNlcjcxMTI3NDY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/71127464?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/connortann",
    "html_url": "https://github.com/connortann",
    "followers_url": "https://api.github.com/users/connortann/followers",
    "following_url": "https://api.github.com/users/connortann/following{/other_user}",
    "gists_url": "https://api.github.com/users/connortann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/connortann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/connortann/subscriptions",
    "organizations_url": "https://api.github.com/users/connortann/orgs",
    "repos_url": "https://api.github.com/users/connortann/repos",
    "events_url": "https://api.github.com/users/connortann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/connortann/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/2273/reactions",
    "total_count": 11,
    "+1": 11,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/2273/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
