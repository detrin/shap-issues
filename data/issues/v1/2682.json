{
  "url": "https://api.github.com/repos/shap/shap/issues/2682",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/2682/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/2682/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/2682/events",
  "html_url": "https://github.com/shap/shap/issues/2682",
  "id": 1372935375,
  "node_id": "I_kwDOBHDcK85R1VTP",
  "number": 2682,
  "title": "Error: Object of type Decimal is not JSON serializable",
  "user": {
    "login": "nikitosl",
    "id": 12246606,
    "node_id": "MDQ6VXNlcjEyMjQ2NjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/12246606?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikitosl",
    "html_url": "https://github.com/nikitosl",
    "followers_url": "https://api.github.com/users/nikitosl/followers",
    "following_url": "https://api.github.com/users/nikitosl/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikitosl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikitosl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikitosl/subscriptions",
    "organizations_url": "https://api.github.com/users/nikitosl/orgs",
    "repos_url": "https://api.github.com/users/nikitosl/repos",
    "events_url": "https://api.github.com/users/nikitosl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikitosl/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-09-14T12:50:46Z",
  "updated_at": "2022-09-14T12:50:46Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**force_plot** on top of catboost classification model raise json serialization error.\r\nModel fitted on features types: object, np.float32 (no Decimal in features).\r\nTook code from [example](https://shap.readthedocs.io/en/latest/example_notebooks/tabular_examples/tree_based_models/Catboost%20tutorial.html) for catboost.\r\n\r\nCode:\r\n```\r\nimport shap\r\nshap.initjs()\r\n\r\ntemp_df = valid_df.sample(100)\r\nX = temp_df[all_features]\r\n\r\nexplainer = shap.TreeExplainer(model)\r\nshap_values = explainer.shap_values(X)\r\n\r\nshap.force_plot(explainer.expected_value, shap_values, X, feature_names=all_features)\r\n```\r\n\r\nError:\r\n```\r\nFile /usr/local/lib/python3.8/dist-packages/shap/plots/_force.py:489, in AdditiveForceArrayVisualizer._repr_html_(self)\r\n    488 def _repr_html_(self):\r\n--> 489     return self.html()\r\n\r\nFile /usr/local/lib/python3.8/dist-packages/shap/plots/_force.py:486, in AdditiveForceArrayVisualizer.html(self)\r\n    477     def html(self):\r\n    478         # assert have_ipython, \"IPython must be installed to use this visualizer! Run `pip install ipython` and then restart shap.\"\r\n    479         return \"\"\"\r\n    480 <div id='{id}'>{err_msg}</div>\r\n    481  <script>\r\n    482    if (window.SHAP) SHAP.ReactDom.render(\r\n    483     SHAP.React.createElement(SHAP.AdditiveForceArrayVisualizer, {data}),\r\n    484     document.getElementById('{id}')\r\n    485   );\r\n--> 486 </script>\"\"\".format(err_msg=err_msg, data=json.dumps(self.data), id=id_generator())\r\n\r\nTypeError: Object of type Decimal is not JSON serializable\r\n```\r\n\r\nPackages versions:\r\n```\r\nshap==0.41.0\r\njson5==0.9.8\r\ncatboost==1.0.6\r\n```\r\nTested same code on _Mac M1 Monterey 12.4_ and _Linux Ubuntu 20.04.4_",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/2682/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/2682/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
