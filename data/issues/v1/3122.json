{
  "url": "https://api.github.com/repos/shap/shap/issues/3122",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/3122/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/3122/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/3122/events",
  "html_url": "https://github.com/shap/shap/issues/3122",
  "id": 1816701670,
  "node_id": "I_kwDOBHDcK85sSKrm",
  "number": 3122,
  "title": "[Meta-issue]: Update major versions of javascript dependencies",
  "user": {
    "login": "connortann",
    "id": 71127464,
    "node_id": "MDQ6VXNlcjcxMTI3NDY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/71127464?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/connortann",
    "html_url": "https://github.com/connortann",
    "followers_url": "https://api.github.com/users/connortann/followers",
    "following_url": "https://api.github.com/users/connortann/following{/other_user}",
    "gists_url": "https://api.github.com/users/connortann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/connortann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/connortann/subscriptions",
    "organizations_url": "https://api.github.com/users/connortann/orgs",
    "repos_url": "https://api.github.com/users/connortann/repos",
    "events_url": "https://api.github.com/users/connortann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/connortann/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2120761626,
      "node_id": "MDU6TGFiZWwyMTIwNzYxNjI2",
      "url": "https://api.github.com/repos/shap/shap/labels/dependencies",
      "name": "dependencies",
      "color": "0366d6",
      "default": false,
      "description": "Pull requests that update a dependency file"
    },
    {
      "id": 5748186552,
      "node_id": "LA_kwDOBHDcK88AAAABVp5duA",
      "url": "https://api.github.com/repos/shap/shap/labels/javascript",
      "name": "javascript",
      "color": "29F6DD",
      "default": false,
      "description": "Relating to the shapjs javascript package"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-07-22T09:39:54Z",
  "updated_at": "2023-08-21T10:44:39Z",
  "closed_at": "2023-08-20T21:17:33Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "The JS package dependencies are several years out of date, and we have several **security advisories** and NPM warnings about deprecated and unsupported packages.\r\n\r\nCurrent versions contain breaking changes, and currently break the build. We should update the relevant packages, and then do some thorough manual testing of the new JS bundle.\r\n\r\n## TODO\r\n\r\n### CICID prep\r\n\r\n- [x] Get build running on CI\r\n- [x] Add jest tests on CI\r\n- [x] Get dependabot updates working\r\n\r\n### Updates\r\n\r\n- [x] Apply non-breaking minor updates to all packages\r\n- [x] Update webpack\r\n   - #3116 \r\n   - [x] Fix broken `npm run dev` server\r\n- [x] Update D3\r\n   - #3114 \r\n   - #3132\r\n   - #3133\r\n- [x] Update react\r\n   - [x] Remove deprecated/outdated `react-tap-event-plugin`\r\n   - [x] #3161\r\n- [x] Update SSL provider\r\n   - #3102  \r\n- [x] Confirm all JS-related Security advisories are fixed\r\n\r\n\r\n### Testing & deployment\r\n\r\n- [x] Manual testing of all JS plots\r\n- [x] Recreate `bundle.js` and place in python package\r\n   - #3148\r\n- [ ] Reset dependabot update frequency to monthly\r\n- [ ] New release of npm package?\r\n\r\n## Manually testing changes\r\n\r\nTo manually build and test the javascript bundle:\r\n\r\n1. Run `npm run build` from the `javascript/` directory to build the bundle\r\n2. Copy `javascript/build/bundle.js` into `shap/plots/resources/`\r\n3. Create an example force plot, as below\r\n\r\n```python\r\n# Example plot to test\r\nimport xgboost\r\nimport shap\r\n\r\nshap.initjs()\r\nX,y = shap.datasets.california()\r\nbst = xgboost.train({\"learning_rate\": 0.01}, xgboost.DMatrix(X, label=y), 100)\r\nexplainer = shap.TreeExplainer(bst)\r\nshap_values = explainer.shap_values(X)\r\nshap.force_plot(explainer.expected_value, shap_values[0:100,:], X.iloc[0:100,:])\r\n```\r\n\r\nExample output:\r\n\r\n![image](https://github.com/shap/shap/assets/71127464/feec65a8-35d7-4e10-a3f0-5cc7fd13f2d2)",
  "closed_by": {
    "login": "connortann",
    "id": 71127464,
    "node_id": "MDQ6VXNlcjcxMTI3NDY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/71127464?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/connortann",
    "html_url": "https://github.com/connortann",
    "followers_url": "https://api.github.com/users/connortann/followers",
    "following_url": "https://api.github.com/users/connortann/following{/other_user}",
    "gists_url": "https://api.github.com/users/connortann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/connortann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/connortann/subscriptions",
    "organizations_url": "https://api.github.com/users/connortann/orgs",
    "repos_url": "https://api.github.com/users/connortann/repos",
    "events_url": "https://api.github.com/users/connortann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/connortann/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/3122/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/3122/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
