{
  "url": "https://api.github.com/repos/shap/shap/issues/2006",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/2006/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/2006/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/2006/events",
  "html_url": "https://github.com/shap/shap/pull/2006",
  "id": 898765853,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NjUwNTk5OTYy",
  "number": 2006,
  "title": "changes:",
  "user": {
    "login": "hfwittmann",
    "id": 6077743,
    "node_id": "MDQ6VXNlcjYwNzc3NDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6077743?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hfwittmann",
    "html_url": "https://github.com/hfwittmann",
    "followers_url": "https://api.github.com/users/hfwittmann/followers",
    "following_url": "https://api.github.com/users/hfwittmann/following{/other_user}",
    "gists_url": "https://api.github.com/users/hfwittmann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hfwittmann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hfwittmann/subscriptions",
    "organizations_url": "https://api.github.com/users/hfwittmann/orgs",
    "repos_url": "https://api.github.com/users/hfwittmann/repos",
    "events_url": "https://api.github.com/users/hfwittmann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hfwittmann/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2021-05-22T09:44:42Z",
  "updated_at": "2021-05-22T09:48:58Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/shap/shap/pulls/2006",
    "html_url": "https://github.com/shap/shap/pull/2006",
    "diff_url": "https://github.com/shap/shap/pull/2006.diff",
    "patch_url": "https://github.com/shap/shap/pull/2006.patch",
    "merged_at": null
  },
  "body": "SHAP is an excellent package.\r\nHowever, currently, for some users not using jupyter but e.g. streamlit, it is difficult to use some of the plots for instance shap.plots.text.\r\n\r\nhttps://shap.readthedocs.io/en/latest/example_notebooks/text_examples/sentiment_analysis/Positive%20vs.%20Negative%20Sentiment%20Classification.html\r\n\r\nIn order to overcome this difficulty I've made some minimal changes (which are also fully compatible), which I feel might be helpful for the community.\r\n\r\nIn the shap.plots.text function I have introduced the new argument mylist, which collects the html snippets produced in the text function. It can later be used in different environments e.g. for streamlit, but also in jupyter.\r\n\r\nHere's an example based on \r\nhttps://shap.readthedocs.io/en/latest/example_notebooks/text_examples/sentiment_analysis/Positive%20vs.%20Negative%20Sentiment%20Classification.html\r\nhow it can be used together with streamlit.\r\n\r\n```\r\nimport transformers\r\nimport datasets\r\nimport shap\r\nimport numpy as np\r\n\r\nimport streamlit as st\r\nimport streamlit.components.v1 as components\r\n\r\ndataset = datasets.load_dataset(\"imdb\", split=\"test\")\r\n\r\n# shorten the strings to fit into the pipeline model\r\nshort_data = [v[:500] for v in dataset[\"text\"][:20]]\r\nclassifier = transformers.pipeline('sentiment-analysis', return_all_scores=True)\r\n# define the explainer\r\nexplainer = shap.Explainer(classifier)\r\n# explain the predictions of the pipeline on the first two samples\r\nshap_values = explainer(short_data[:2])\r\n\r\nmylist = []\r\nshap.plots.text(shap_values[:,:,\"POSITIVE\"], mylist=mylist)\r\n\r\nst.header('SHAP in streamlit')\r\n# st.pyplot(fig)\r\n\r\nst.write('')\r\nfor shap_html in mylist:\r\n    components.html(shap_html, height=300, scrolling=True)\r\n```\r\n\r\nHere's a screenshot:\r\n\r\n![image](https://user-images.githubusercontent.com/6077743/119222067-d0087800-baf2-11eb-9782-6d00c12c59aa.png)\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/2006/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/2006/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
