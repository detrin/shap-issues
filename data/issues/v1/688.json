{
  "url": "https://api.github.com/repos/shap/shap/issues/688",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/688/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/688/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/688/events",
  "html_url": "https://github.com/shap/shap/issues/688",
  "id": 465774684,
  "node_id": "MDU6SXNzdWU0NjU3NzQ2ODQ=",
  "number": 688,
  "title": "Question: how to interpret shap with One Hot Encoding + Lasso",
  "user": {
    "login": "jorgecarleitao",
    "id": 2772607,
    "node_id": "MDQ6VXNlcjI3NzI2MDc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2772607?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jorgecarleitao",
    "html_url": "https://github.com/jorgecarleitao",
    "followers_url": "https://api.github.com/users/jorgecarleitao/followers",
    "following_url": "https://api.github.com/users/jorgecarleitao/following{/other_user}",
    "gists_url": "https://api.github.com/users/jorgecarleitao/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jorgecarleitao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jorgecarleitao/subscriptions",
    "organizations_url": "https://api.github.com/users/jorgecarleitao/orgs",
    "repos_url": "https://api.github.com/users/jorgecarleitao/repos",
    "events_url": "https://api.github.com/users/jorgecarleitao/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jorgecarleitao/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-07-09T13:15:54Z",
  "updated_at": "2019-07-10T16:57:33Z",
  "closed_at": "2019-07-10T16:57:33Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "As I am going through the steps of understanding shap, I wrote a small example that I am playing with:\r\n\r\n```\r\nimport numpy as np\r\nfrom sklearn.linear_model import LassoCV\r\nfrom sklearn.preprocessing import OneHotEncoder, StandardScaler\r\nimport shap\r\n\r\n# -4, -2, 0, 2, 4\r\ny = np.array([-2 * ((i % 5) - 2) for i in range(100)])\r\nx = np.array(['a', 'b', 'c', 'd', 'e'] * 20)\r\n\r\nohe = OneHotEncoder(sparse=False)\r\n# ohe = OneHotEncoder(sparse=False, drop='first')\r\n\r\nx = ohe.fit_transform(np.array([x]).T)\r\n\r\ns = StandardScaler()\r\nx = s.fit_transform(x)\r\n# s.fit(x)\r\n\r\nlasso = LassoCV(normalize=False, cv=5)\r\n\r\nlasso.fit(x, y)\r\n\r\n#print(lasso.coef_ / s.scale_)  # 4, 2, 0, -2, -4\r\n\r\nprint(shap.LinearExplainer(lasso, x).shap_values(x[:5]) / s.scale_)\r\n# print(shap.LinearExplainer(lasso, x).shap_values(x[:4]) / s.scale_)\r\n\r\n\"\"\"\r\n[[ 7.99276331 -0.99816581 -0.          0.99785593  1.99787483]\r\n [-1.99819083  3.99266322 -0.          0.99785593  1.99787483]\r\n [-1.99819083 -0.99816581  0.          0.99785593  1.99787483]\r\n [-1.99819083 -0.99816581 -0.         -3.99142374  1.99787483]\r\n [-1.99819083 -0.99816581 -0.          0.99785593 -7.9914993 ]]\r\n\"\"\"\r\n```\r\n\r\nLooking at the diagonal of this matrix, which corresponds to the values of `1` in x, I get  `8, 4, 0, -4, -8`. Where do these values come from and how can we interpret shap in this example?",
  "closed_by": {
    "login": "jorgecarleitao",
    "id": 2772607,
    "node_id": "MDQ6VXNlcjI3NzI2MDc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2772607?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jorgecarleitao",
    "html_url": "https://github.com/jorgecarleitao",
    "followers_url": "https://api.github.com/users/jorgecarleitao/followers",
    "following_url": "https://api.github.com/users/jorgecarleitao/following{/other_user}",
    "gists_url": "https://api.github.com/users/jorgecarleitao/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jorgecarleitao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jorgecarleitao/subscriptions",
    "organizations_url": "https://api.github.com/users/jorgecarleitao/orgs",
    "repos_url": "https://api.github.com/users/jorgecarleitao/repos",
    "events_url": "https://api.github.com/users/jorgecarleitao/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jorgecarleitao/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/688/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/688/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
