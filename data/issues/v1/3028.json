{
  "url": "https://api.github.com/repos/shap/shap/issues/3028",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/3028/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/3028/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/3028/events",
  "html_url": "https://github.com/shap/shap/pull/3028",
  "id": 1770284873,
  "node_id": "PR_kwDOBHDcK85TsEKU",
  "number": 3028,
  "title": "FIX: Update cibuildwheel config with supported architectures and import-mode",
  "user": {
    "login": "connortann",
    "id": 71127464,
    "node_id": "MDQ6VXNlcjcxMTI3NDY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/71127464?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/connortann",
    "html_url": "https://github.com/connortann",
    "followers_url": "https://api.github.com/users/connortann/followers",
    "following_url": "https://api.github.com/users/connortann/following{/other_user}",
    "gists_url": "https://api.github.com/users/connortann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/connortann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/connortann/subscriptions",
    "organizations_url": "https://api.github.com/users/connortann/orgs",
    "repos_url": "https://api.github.com/users/connortann/repos",
    "events_url": "https://api.github.com/users/connortann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/connortann/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 486901329,
      "node_id": "MDU6TGFiZWw0ODY5MDEzMjk=",
      "url": "https://api.github.com/repos/shap/shap/labels/bug",
      "name": "bug",
      "color": "ee0701",
      "default": true,
      "description": "Indicates an unexpected problem or unintended behaviour"
    },
    {
      "id": 5577305596,
      "node_id": "LA_kwDOBHDcK88AAAABTG7t_A",
      "url": "https://api.github.com/repos/shap/shap/labels/ci",
      "name": "ci",
      "color": "006b75",
      "default": false,
      "description": "Relating to Continuous Integration / GitHub Actions"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/shap/shap/milestones/1",
    "html_url": "https://github.com/shap/shap/milestone/1",
    "labels_url": "https://api.github.com/repos/shap/shap/milestones/1/labels",
    "id": 9481651,
    "node_id": "MI_kwDOBHDcK84AkK2z",
    "number": 1,
    "title": "2023-06-fixes",
    "description": null,
    "creator": {
      "login": "connortann",
      "id": 71127464,
      "node_id": "MDQ6VXNlcjcxMTI3NDY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/71127464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/connortann",
      "html_url": "https://github.com/connortann",
      "followers_url": "https://api.github.com/users/connortann/followers",
      "following_url": "https://api.github.com/users/connortann/following{/other_user}",
      "gists_url": "https://api.github.com/users/connortann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/connortann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/connortann/subscriptions",
      "organizations_url": "https://api.github.com/users/connortann/orgs",
      "repos_url": "https://api.github.com/users/connortann/repos",
      "events_url": "https://api.github.com/users/connortann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/connortann/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 22,
    "state": "closed",
    "created_at": "2023-06-03T11:00:10Z",
    "updated_at": "2023-07-03T13:09:14Z",
    "due_on": null,
    "closed_at": "2023-07-03T13:07:50Z"
  },
  "comments": 5,
  "created_at": "2023-06-22T19:39:26Z",
  "updated_at": "2023-06-26T05:04:55Z",
  "closed_at": "2023-06-26T05:04:31Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/shap/shap/pulls/3028",
    "html_url": "https://github.com/shap/shap/pull/3028",
    "diff_url": "https://github.com/shap/shap/pull/3028.diff",
    "patch_url": "https://github.com/shap/shap/pull/3028.patch",
    "merged_at": "2023-06-26T05:04:31Z"
  },
  "body": "### Overview\r\n\r\nCloses most of #3012 \r\n\r\n- Edits the cibuildwheel config to specify the precise set of supported architectures, copying the set used by sklearn.\r\n- Changes the test invocation to fix an issue where the wrong library was imported, and `cext` is missing.\r\n\r\nExample [wheel build run](https://github.com/slundberg/shap/actions/runs/5351527272)\r\n\r\n### Import issue\r\n\r\nThis took me many hours to debug. More info in https://github.com/slundberg/shap/issues/3012#issuecomment-1603448067\r\n\r\n### Architectures\r\n\r\nPreviously a very broad array of architectures were attempted by cibuildwheel. The full list of is given [here](https://cibuildwheel.readthedocs.io/en/stable/options/#build-skip).\r\n\r\nMany of these are not well supported by the wider scientific python ecosystem, and wheels are not available for dependencies. The shap wheel tests fail because the dependencies cannot be built from source easily. For example, `scipy` publishes [wheels](https://pypi.org/project/scipy/#files) for win64 but not win32, as explained in this [thread](https://github.com/scikit-learn/scikit-learn/blob/main/.github/workflows/wheels.yml).\r\n\r\nI propose creating wheels for the same set of architectures as used by scikit-learn, which is given in their build matrix [here](https://github.com/scikit-learn/scikit-learn/blob/main/.github/workflows/wheels.yml).\r\n\r\nI note that several recent releases of shap only included wheels for a small subset of architectures. SHAP 0.39 only [published wheels](https://pypi.org/project/shap/0.39.0/#files) for `win_amd64`.\r\n\r\nAnother option could be to publish wheels for a wide range of architectures, but disable testing for them. This seems rather risky to be, as I think we should only publish what we can test. In any case, the source distribution is available as an alternative for esoteric scenarios.\r\n\r\n## Checklist\r\n\r\n- [ ] Confirm wheel workflow passes\r\n- [ ] Added entry to `CHANGELOG.md` (if changes will affect users)\r\n",
  "closed_by": {
    "login": "thatlittleboy",
    "id": 30731072,
    "node_id": "MDQ6VXNlcjMwNzMxMDcy",
    "avatar_url": "https://avatars.githubusercontent.com/u/30731072?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thatlittleboy",
    "html_url": "https://github.com/thatlittleboy",
    "followers_url": "https://api.github.com/users/thatlittleboy/followers",
    "following_url": "https://api.github.com/users/thatlittleboy/following{/other_user}",
    "gists_url": "https://api.github.com/users/thatlittleboy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thatlittleboy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thatlittleboy/subscriptions",
    "organizations_url": "https://api.github.com/users/thatlittleboy/orgs",
    "repos_url": "https://api.github.com/users/thatlittleboy/repos",
    "events_url": "https://api.github.com/users/thatlittleboy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thatlittleboy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/3028/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/3028/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
