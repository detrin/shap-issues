{
  "url": "https://api.github.com/repos/shap/shap/issues/2918",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/2918/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/2918/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/2918/events",
  "html_url": "https://github.com/shap/shap/issues/2918",
  "id": 1703089945,
  "node_id": "I_kwDOBHDcK85lgxcZ",
  "number": 2918,
  "title": "shap.TreeExplainer error with np.bool",
  "user": {
    "login": "mini90140",
    "id": 133079078,
    "node_id": "U_kgDOB-6gJg",
    "avatar_url": "https://avatars.githubusercontent.com/u/133079078?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mini90140",
    "html_url": "https://github.com/mini90140",
    "followers_url": "https://api.github.com/users/mini90140/followers",
    "following_url": "https://api.github.com/users/mini90140/following{/other_user}",
    "gists_url": "https://api.github.com/users/mini90140/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mini90140/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mini90140/subscriptions",
    "organizations_url": "https://api.github.com/users/mini90140/orgs",
    "repos_url": "https://api.github.com/users/mini90140/repos",
    "events_url": "https://api.github.com/users/mini90140/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mini90140/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-05-10T04:10:44Z",
  "updated_at": "2023-05-10T04:26:31Z",
  "closed_at": "2023-05-10T04:26:31Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I try to use my old code in Jupyter and get shap value from XGB regression as follow:\r\n\r\n```\r\nxg_reg = xgb.XGBRegressor(...)\r\nxg_reg.fit(X_train,Y_train)\r\nexplainer = shap.TreeExplainer(xg_reg,X_train)\r\n```\r\nwhere      type(X_train) = pandas.core.frame.DataFrame.\r\n\r\n\r\n\r\nThen I encounter the error as follow:\r\n\r\n```\r\nIn the future `np.bool` will be defined as the corresponding NumPy scalar.\r\n\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-20-d2ec65b7e49d> in <module>\r\n     40             ##### Train Shap #####\r\n     41 \r\n---> 42             explainer = shap.TreeExplainer(xg_reg,data=np.array(X_train))\r\n     43             X_shap1, X_shap2 = train_test_split(X_train, test_size=0.01)\r\n     44             shap_values = explainer.shap_values(X_shap2)\r\n\r\n~/.local/lib/python3.8/site-packages/shap/explainers/_tree.py in __init__(self, model, data, model_output, feature_perturbation, feature_names, approximate, **deprecated_options)\r\n     99 \r\n    100         masker = data\r\n--> 101         super(Tree, self).__init__(model, masker, feature_names=feature_names)\r\n    102 \r\n    103         if type(self.masker) is maskers.Independent:\r\n\r\n~/.local/lib/python3.8/site-packages/shap/explainers/_explainer.py in __init__(self, model, masker, link, algorithm, output_names, feature_names, linearize_link, seed, **kwargs)\r\n     86                 self.masker = maskers.Partition(masker)\r\n     87             else:\r\n---> 88                 self.masker = maskers.Independent(masker)\r\n     89         elif safe_isinstance(masker, [\"transformers.PreTrainedTokenizer\", \"transformers.tokenization_utils_base.PreTrainedTokenizerBase\"]):\r\n     90             if is_transformers_lm(self.model):\r\n\r\n~/.local/lib/python3.8/site-packages/shap/maskers/_tabular.py in __init__(self, data, max_samples)\r\n    260             about 1, 10, 100, or 1000 background samples are reasonable choices.\r\n    261         \"\"\"\r\n--> 262         super().__init__(data, max_samples=max_samples, clustering=None)\r\n    263 \r\n    264 \r\n\r\n~/.local/lib/python3.8/site-packages/shap/maskers/_tabular.py in __init__(self, data, max_samples, clustering)\r\n     80         # self._last_mask = np.zeros(self.data.shape[1], dtype=np.bool)\r\n     81         self._masked_data = data.copy()\r\n---> 82         self._last_mask = np.zeros(data.shape[1], dtype=np.bool)\r\n     83         self.shape = self.data.shape\r\n     84         self.supports_delta_masking = True\r\n\r\n~/.local/lib/python3.8/site-packages/numpy/__init__.py in __getattr__(attr)\r\n    303 \r\n    304         if attr in __former_attrs__:\r\n--> 305             raise AttributeError(__former_attrs__[attr])\r\n    306 \r\n    307         # Importing Tester requires importing all of UnitTest which is not a\r\n\r\nAttributeError: module 'numpy' has no attribute 'bool'.\r\n`np.bool` was a deprecated alias for the builtin `bool`. To avoid this error in existing code, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.\r\nThe aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:\r\n    https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n```\r\n\r\n\r\nI’ve tried editing dtype=np.bool to dtype=np.bool_ in ~/.local/lib/python3.8/site-packages/shap/maskers/_tabular.py.\r\nAlso I’ve tried install older version of numpy with `pip install mxnet-mkl==1.6.0 numpy==1.23.1.`\r\nProblem is still the same. Any advice?\r\n\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "mini90140",
    "id": 133079078,
    "node_id": "U_kgDOB-6gJg",
    "avatar_url": "https://avatars.githubusercontent.com/u/133079078?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mini90140",
    "html_url": "https://github.com/mini90140",
    "followers_url": "https://api.github.com/users/mini90140/followers",
    "following_url": "https://api.github.com/users/mini90140/following{/other_user}",
    "gists_url": "https://api.github.com/users/mini90140/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mini90140/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mini90140/subscriptions",
    "organizations_url": "https://api.github.com/users/mini90140/orgs",
    "repos_url": "https://api.github.com/users/mini90140/repos",
    "events_url": "https://api.github.com/users/mini90140/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mini90140/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/2918/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/2918/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
