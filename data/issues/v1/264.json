{
  "url": "https://api.github.com/repos/shap/shap/issues/264",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/264/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/264/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/264/events",
  "html_url": "https://github.com/shap/shap/issues/264",
  "id": 361426186,
  "node_id": "MDU6SXNzdWUzNjE0MjYxODY=",
  "number": 264,
  "title": "plot_cmap not working in all cases",
  "user": {
    "login": "gabrielcs",
    "id": 1621008,
    "node_id": "MDQ6VXNlcjE2MjEwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1621008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gabrielcs",
    "html_url": "https://github.com/gabrielcs",
    "followers_url": "https://api.github.com/users/gabrielcs/followers",
    "following_url": "https://api.github.com/users/gabrielcs/following{/other_user}",
    "gists_url": "https://api.github.com/users/gabrielcs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gabrielcs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gabrielcs/subscriptions",
    "organizations_url": "https://api.github.com/users/gabrielcs/orgs",
    "repos_url": "https://api.github.com/users/gabrielcs/repos",
    "events_url": "https://api.github.com/users/gabrielcs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gabrielcs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-09-18T18:24:15Z",
  "updated_at": "2020-11-04T02:18:34Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I am trying to customize the `force_plot` colors with [Seaborn](http://seaborn.pydata.org) but I am getting the following exceptions, according to whether I use `as_cmap=True`:\r\n\r\n```python\r\nplot_cmap=sns.diverging_palette(15, 155, s=99, l=70, n=2)\r\n```\r\nresults in:\r\n```python\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\nshap/plots/force.py in force_plot(base_value, shap_values, features, feature_names, out_names, link, plot_cmap)\r\n     92             DenseData(np.zeros((1, len(feature_names))), list(feature_names))\r\n     93         )\r\n---> 94         return visualize(e, plot_cmap)\r\n     95 \r\n     96     else:\r\n\r\nshap/plots/force.py in visualize(e, plot_cmap)\r\n    188 \r\n    189 def visualize(e, plot_cmap=\"RdBu\"):\r\n--> 190     plot_cmap = verify_valid_cmap(plot_cmap)\r\n    191     if isinstance(e, AdditiveExplanation):\r\n    192         return AdditiveForceVisualizer(e, plot_cmap=plot_cmap).html()\r\n\r\nshap/plots/force.py in verify_valid_cmap(cmap)\r\n    183         _rgbstring = re.compile(r'#[a-fA-F0-9]{6}$')\r\n    184         for color in cmap:\r\n--> 185              assert(bool(_rgbstring.match(color))),\"Invalid color found in CMAP.\"\r\n    186 \r\n    187     return cmap\r\n\r\nTypeError: cannot use a string pattern on a bytes-like object\r\n```\r\n\r\nAnd setting `as_cmap=True` \r\n```python\r\nplot_cmap=sns.diverging_palette(15, 155, s=99, l=70, n=2, as_cmap=True)\r\n```\r\nresults in:\r\n```python\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\nshap/plots/force.py in force_plot(base_value, shap_values, features, feature_names, out_names, link, plot_cmap)\r\n     92             DenseData(np.zeros((1, len(feature_names))), list(feature_names))\r\n     93         )\r\n---> 94         return visualize(e, plot_cmap)\r\n     95 \r\n     96     else:\r\n\r\nshap/plots/force.py in visualize(e, plot_cmap)\r\n    188 \r\n    189 def visualize(e, plot_cmap=\"RdBu\"):\r\n--> 190     plot_cmap = verify_valid_cmap(plot_cmap)\r\n    191     if isinstance(e, AdditiveExplanation):\r\n    192         return AdditiveForceVisualizer(e, plot_cmap=plot_cmap).html()\r\n\r\nshap/plots/force.py in verify_valid_cmap(cmap)\r\n    178 def verify_valid_cmap(cmap):\r\n    179     assert (isinstance(cmap, str) or isinstance(cmap, list) or str(type(cmap)).endswith(\"unicode'>\")\r\n--> 180         ),\"Plot color map must be string or list! not: \" + str(type(cmap))\r\n    181     if isinstance(cmap, list):\r\n    182         assert (len(cmap) > 1), \"Color map must be at least two colors.\"\r\n\r\nAssertionError: Plot color map must be string or list! not: <class 'matplotlib.colors.LinearSegmentedColormap'>\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/264/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/264/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
