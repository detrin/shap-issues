{
  "url": "https://api.github.com/repos/shap/shap/issues/215",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/215/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/215/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/215/events",
  "html_url": "https://github.com/shap/shap/issues/215",
  "id": 350064427,
  "node_id": "MDU6SXNzdWUzNTAwNjQ0Mjc=",
  "number": 215,
  "title": "Tree Shap gives extremely high shap values while Kernel Shap doesn't",
  "user": {
    "login": "GrimLefourbe",
    "id": 17729035,
    "node_id": "MDQ6VXNlcjE3NzI5MDM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/17729035?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/GrimLefourbe",
    "html_url": "https://github.com/GrimLefourbe",
    "followers_url": "https://api.github.com/users/GrimLefourbe/followers",
    "following_url": "https://api.github.com/users/GrimLefourbe/following{/other_user}",
    "gists_url": "https://api.github.com/users/GrimLefourbe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/GrimLefourbe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/GrimLefourbe/subscriptions",
    "organizations_url": "https://api.github.com/users/GrimLefourbe/orgs",
    "repos_url": "https://api.github.com/users/GrimLefourbe/repos",
    "events_url": "https://api.github.com/users/GrimLefourbe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/GrimLefourbe/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2018-08-13T14:53:02Z",
  "updated_at": "2019-11-14T23:45:14Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello there,\r\n\r\nI have recently been trying to evaluate SHAP and its reliability. In order to do this, I've been generating datasets with random values and labeled them according to arbitrary conditions (eg: feature_0 < 0.05, feature_1 < 0.95). I have then fitted a RandomForestClassifier from sklearn on the data and explained its predictions. It has worked fairly well for boolean conditions.\r\n\r\nI think I ran into what seems to me like a bug with the Tree Shap algorithm. With a condition that includes an addition, the classifier starts having difficulties to predict. In turn, the TreeExplainer starts producing extremely high values while the KernelExplainer outputs values in the usual range. The Kernel Explainer is able to definitively point to the relevant features as showcased in its summary plot while the Tree Explainer's summary plot is much less definitive in its responsibilities.\r\n\r\nTree SHAP summary plot\r\n![image](https://user-images.githubusercontent.com/17729035/44038945-39293e90-9f18-11e8-88a7-ccfb1098453d.png)\r\n\r\nKernel SHAP summary plot\r\n![image](https://user-images.githubusercontent.com/17729035/44038964-4a633710-9f18-11e8-89c4-07e5dde3c0ba.png)\r\n\r\nIs this expected? Is it a predictable behavior for the algorithm ?\r\n\r\nI have also included a jupyter notebook with the necessary code for data/feature generation and other code required to reproduce the issue.\r\n\r\n[Shap Values Tree vs Kernel.ipynb.zip](https://github.com/slundberg/shap/files/2283384/Shap.Values.Tree.vs.Kernel.ipynb.zip)\r\n\r\nPlease, let me know if you need details on how to reproduce this.\r\n\r\nThanks for your time and your work.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/215/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/215/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
