{
  "url": "https://api.github.com/repos/shap/shap/issues/1743",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1743/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1743/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1743/events",
  "html_url": "https://github.com/shap/shap/issues/1743",
  "id": 786065645,
  "node_id": "MDU6SXNzdWU3ODYwNjU2NDU=",
  "number": 1743,
  "title": "TypeError: __init__() got an unexpected keyword argument 'feature_names'",
  "user": {
    "login": "netoolii",
    "id": 13889128,
    "node_id": "MDQ6VXNlcjEzODg5MTI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/13889128?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/netoolii",
    "html_url": "https://github.com/netoolii",
    "followers_url": "https://api.github.com/users/netoolii/followers",
    "following_url": "https://api.github.com/users/netoolii/following{/other_user}",
    "gists_url": "https://api.github.com/users/netoolii/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/netoolii/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/netoolii/subscriptions",
    "organizations_url": "https://api.github.com/users/netoolii/orgs",
    "repos_url": "https://api.github.com/users/netoolii/repos",
    "events_url": "https://api.github.com/users/netoolii/events{/privacy}",
    "received_events_url": "https://api.github.com/users/netoolii/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-01-14T15:07:49Z",
  "updated_at": "2023-06-03T01:18:39Z",
  "closed_at": "2023-06-03T01:18:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Trying to instantiate Explainer and reproduce the following code at  [https://github.com/slundberg/shap/blob/master/notebooks/text_examples/sentiment_analysis/Emotion%20Data%20Multiclass%20Text%20Explanation%20Demo.ipynb](https://github.com/slundberg/shap/blob/master/notebooks/text_examples/sentiment_analysis/Emotion%20Data%20Multiclass%20Text%20Explanation%20Demo.ipynb)\r\n\r\nI got this error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-49-4f411f5b2215> in <module>\r\n----> 1 explainer = shap.Explainer(f,e,output_names=predictor_explainable.tg_mapping.values())\r\n\r\n~/.conda/envs/exp/lib/python3.7/site-packages/shap/explainers/_explainer.py in __init__(self, model, masker, link, algorithm, output_names, feature_names, **kwargs)\r\n    136             elif algorithm == \"permutation\":\r\n    137                 self.__class__ = explainers.Permutation\r\n--> 138                 explainers.Permutation.__init__(self, model, self.masker, link=self.link, feature_names=self.feature_names, **kwargs)\r\n    139             elif algorithm == \"partition\":\r\n    140                 self.__class__ = explainers.Partition\r\n\r\nTypeError: __init__() got an unexpected keyword argument 'feature_names'\r\n```\r\n\r\nSearching for this file I found the constructor:\r\n\r\n```\r\n/home/mycomputer/.conda/envs/exp/lib/python3.7/site-packages/shap/explainers/_permutation.py\r\nclass Permutation(Explainer):\r\n    \"\"\" This method approximates the Shapley values by iterating through permutations of the inputs.\r\n\r\n    This is a model agnostic explainer that gurantees local accuracy (additivity) by iterating completely\r\n    through an entire permutatation of the features in both forward and reverse directions. If we do this\r\n    once, then we get the exact SHAP values for models with up to second order interaction effects. We can\r\n    iterate this many times over many random permutations to get better SHAP value estimates for models\r\n    with higher order interactions. This sequential ordering formulation also allows for easy reuse of\r\n    model evaluations and the ability to effciently avoid evaluating the model when the background values\r\n    for a feature are the same as the current input value. We can also account for hierarchial data\r\n    structures with partition trees, something not currently implemented for KernalExplainer or SamplingExplainer.\r\n    \"\"\"\r\n\r\n    def __init__(self, model, masker, link=links.identity):\r\n        \"\"\" Build an explainers.Permutation object for the given model using the given masker object.\r\n\r\n        Parameters\r\n        ----------\r\n        model : function\r\n            A callable python object that executes the model given a set of input data samples.\r\n\r\n        masker : function or numpy.array or pandas.DataFrame\r\n            A callable python object used to \"mask\" out hidden features of the form `masker(x, mask)`.\r\n            It takes a single input sample and a binary mask and returns a matrix of masked samples. These\r\n            masked samples are evaluated using the model function and the outputs are then averaged.\r\n            As a shortcut for the standard masking using by SHAP you can pass a background data matrix\r\n            instead of a function and that matrix will be used for masking. To use a clustering\r\n            game structure you can pass a shap.maksers.Tabular(data, clustering=\\\"correlation\\\") object.\r\n        \"\"\"\r\n        super(Permutation, self).__init__(model, masker, link=link)\r\n```\r\n\r\nif you look, the Permutation and the other classes do not have `feature_names` as an argument\r\n\r\n\r\n**Libraries installed**\r\n\r\n```\r\nPython 3.7.4 \r\n\r\n\r\nPackage                           Version       \r\n--------------------------------- --------------\r\nabsl-py                           0.9.0         \r\naiohttp                           3.6.2         \r\nappdirs                           1.4.4         \r\nAPScheduler                       3.6.3         \r\nasn1crypto                        1.3.0         \r\nastor                             0.8.1         \r\nastunparse                        1.6.3         \r\nasync-timeout                     3.0.1         \r\nattrs                             19.3.0        \r\nautokeras                         1.0.2         \r\nautopep8                          1.5.4         \r\nbackcall                          0.1.0         \r\nbeautifulsoup4                    4.6.0         \r\nbleach                            3.1.4         \r\nblinker                           1.4           \r\nboto                              2.49.0        \r\nboto3                             1.12.39       \r\nbotocore                          1.15.39       \r\ncachetools                        3.1.1         \r\ncertifi                           2020.4.5.1    \r\ncffi                              1.14.0        \r\nchardet                           3.0.4         \r\ncld2-cffi                         0.1.4         \r\nclick                             7.1.2         \r\ncloudpickle                       1.4.1         \r\ncolorama                          0.4.3         \r\nconda                             4.8.1         \r\nconda-package-handling            1.6.0         \r\nconfigparser                      5.0.1         \r\ncryptography                      2.8           \r\ncycler                            0.10.0        \r\ndart-trec-commons                 1.0.0         \r\ndart-trec-learner                 1.0.0         \r\ndask                              2.16.0        \r\ndeap                              1.3.1         \r\ndecorator                         4.4.2         \r\ndefusedxml                        0.6.0         \r\ndill                              0.3.1.1       \r\ndistlib                           0.3.0         \r\ndistributed                       2.16.0        \r\ndnspython                         1.16.0        \r\ndocutils                          0.15.2        \r\nentrypoints                       0.3           \r\nfasttext                          0.9.2         \r\nfilelock                          3.0.12        \r\nflake8                            3.8.4         \r\nfuture                            0.18.2        \r\ngast                              0.3.3         \r\ngensim                            3.8.0         \r\ngoogle                            2.0.3         \r\ngoogle-api-core                   1.16.0        \r\ngoogle-auth                       1.13.1        \r\ngoogle-auth-oauthlib              0.4.1         \r\ngoogle-cloud-core                 1.3.0         \r\ngoogle-cloud-storage              1.27.0        \r\ngoogle-pasta                      0.2.0         \r\ngoogle-resumable-media            0.5.0         \r\ngoogleapis-common-protos          1.51.0        \r\ngrpcio                            1.29.0        \r\nh5py                              2.10.0        \r\nHeapDict                          1.0.1         \r\nidna                              2.9           \r\nimageio                           2.9.0         \r\niml                               0.6.2         \r\nimportlib-metadata                1.6.0         \r\ninfo-gain                         1.0.1         \r\niniconfig                         1.1.1         \r\nipykernel                         5.2.1         \r\nipython                           7.13.0        \r\nipython-genutils                  0.2.0         \r\nipywidgets                        7.5.1         \r\njedi                              0.17.0        \r\nJinja2                            2.11.2        \r\njmespath                          0.9.4         \r\njoblib                            0.14.1        \r\nJPype1                            0.7.3         \r\njson5                             0.9.0         \r\njsonschema                        3.2.0         \r\njupyter-client                    6.1.3         \r\njupyter-contrib-core              0.3.3         \r\njupyter-contrib-nbextensions      0.5.1         \r\njupyter-core                      4.6.3         \r\njupyter-highlight-selected-word   0.2.0         \r\njupyter-latex-envs                1.4.6         \r\njupyter-nbextensions-configurator 0.4.1         \r\njupyterlab                        2.1.1         \r\njupyterlab-server                 1.1.1         \r\njupyterthemes                     0.20.0        \r\nKeras                             2.3.1         \r\nKeras-Applications                1.0.8         \r\nKeras-Preprocessing               1.1.2         \r\nkeras-tuner                       1.0.1         \r\nkiwisolver                        1.1.0         \r\nkonlpy                            0.5.2         \r\nlesscpy                           0.14.0        \r\nlime                              0.2.0.1       \r\nllvmlite                          0.35.0        \r\nlxml                              4.5.0         \r\nMarkdown                          3.2.2         \r\nMarkupSafe                        1.1.1         \r\nmatplotlib                        3.1.3         \r\nmccabe                            0.6.1         \r\nmecab-python                      0.996-ko-0.9.2\r\nminio                             6.0.0         \r\nmistune                           0.8.4         \r\nmkl-fft                           1.0.15        \r\nmkl-random                        1.1.0         \r\nmkl-service                       2.3.0         \r\nmodin                             0.7.3         \r\nmsgpack                           1.0.0         \r\nmultidict                         4.7.5         \r\nmysql-connector-python            8.0.19        \r\nnbconvert                         5.6.1         \r\nnbformat                          5.0.6         \r\nnetworkx                          2.5           \r\nnltk                              3.5           \r\nnotebook                          5.7.8         \r\nnumba                             0.52.0        \r\nnumpy                             1.18.5        \r\noauthlib                          3.1.0         \r\nopt-einsum                        3.2.1         \r\npackaging                         20.3          \r\npandarallel                       1.4.8         \r\npandas                            1.1.2         \r\npandocfilters                     1.4.2         \r\nparso                             0.7.0         \r\npexpect                           4.8.0         \r\npickleshare                       0.7.5         \r\nPillow                            7.2.0         \r\npip                               19.2.3        \r\npipenv                            2020.6.2      \r\npipfile                           0.0.2         \r\npluggy                            0.13.1        \r\nply                               3.11          \r\nprometheus-client                 0.7.1         \r\nprompt-toolkit                    3.0.5         \r\nprotobuf                          3.11.3        \r\npsutil                            5.7.0         \r\nptyprocess                        0.6.0         \r\npy                                1.9.0         \r\npy-spy                            0.3.3         \r\npy4j                              0.10.7        \r\npyarrow                           0.16.0        \r\npyasn1                            0.4.8         \r\npyasn1-modules                    0.2.7         \r\npybind11                          2.5.0         \r\npycld2                            0.41          \r\npycld3                            0.20          \r\npycodestyle                       2.6.0         \r\npycosat                           0.6.3         \r\npycparser                         2.20          \r\npyflakes                          2.2.0         \r\nPygments                          2.6.1         \r\nPyJWT                             1.7.1         \r\npymongo                           3.11.0        \r\nPyMySQL                           0.9.3         \r\npyOpenSSL                         19.1.0        \r\npyparsing                         2.4.6         \r\npyrsistent                        0.16.0        \r\nPySocks                           1.7.1         \r\npyspark                           2.4.4         \r\npytest                            6.1.1         \r\npython-dateutil                   2.8.1         \r\npytz                              2019.3        \r\nPyWavelets                        1.1.1         \r\nPyYAML                            5.3.1         \r\npyzmq                             19.0.0        \r\nray                               0.8.4         \r\nredis                             3.5.1         \r\nregex                             2020.11.13    \r\nrequests                          2.23.0        \r\nrequests-oauthlib                 1.3.0         \r\nrsa                               4.0           \r\nruamel-yaml                       0.15.87       \r\ns3transfer                        0.3.3         \r\nscikit-image                      0.18.0        \r\nscikit-learn                      0.23.2        \r\nscipy                             1.4.1         \r\nseaborn                           0.10.1        \r\nSend2Trash                        1.5.0         \r\nsetuptools                        51.1.2        \r\nshap                              0.37.0        \r\nsip                               4.19.13       \r\nsix                               1.14.0        \r\nslicer                            0.0.3         \r\nsmart-open                        1.11.1        \r\nsortedcontainers                  2.1.0         \r\nspark-nlp                         2.5.1         \r\nSQLAlchemy                        1.3.16        \r\nstopit                            1.1.2         \r\ntabulate                          0.8.7         \r\ntblib                             1.6.0         \r\ntensorboard                       2.4.0         \r\ntensorboard-plugin-wit            1.7.0         \r\ntensorflow                        2.3.1         \r\ntensorflow-estimator              2.3.0         \r\ntensorflow-hub                    0.10.0        \r\ntensorflow-text                   2.3.0         \r\ntermcolor                         1.1.0         \r\nterminado                         0.8.3         \r\nterminaltables                    3.1.0         \r\ntestpath                          0.4.4         \r\nthreadpoolctl                     2.1.0         \r\ntifffile                          2020.12.8     \r\ntoml                              0.10.1        \r\ntoolz                             0.10.0        \r\ntornado                           6.0.4         \r\nTPOT                              0.11.2        \r\ntqdm                              4.36.1        \r\ntraitlets                         4.3.3         \r\ntweepy                            3.8.0         \r\ntwkorean                          0.1.5         \r\ntzlocal                           2.1           \r\nupdate-checker                    0.17          \r\nurllib3                           1.25.8        \r\nvirtualenv                        20.0.24       \r\nvirtualenv-clone                  0.5.4         \r\nwcwidth                           0.1.9         \r\nwebencodings                      0.5.1         \r\nWerkzeug                          1.0.1         \r\nwheel                             0.34.2        \r\nwidgetsnbextension                3.5.1         \r\nwrapt                             1.12.1        \r\nxgboost                           1.1.0         \r\nyapf                              0.30.0        \r\nyarl                              1.4.2         \r\nzict                              2.0.0         \r\nzipp                              3.1.0   \r\n```\r\n\r\n**OS information**\r\n\r\n```\r\nNAME=\"CentOS Linux\"\r\nVERSION=\"7 (Core)\"\r\nID=\"centos\"\r\nID_LIKE=\"rhel fedora\"\r\nVERSION_ID=\"7\"\r\nPRETTY_NAME=\"CentOS Linux 7 (Core)\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:centos:centos:7\"\r\nHOME_URL=\"https://www.centos.org/\"\r\nBUG_REPORT_URL=\"https://bugs.centos.org/\"\r\n\r\nCENTOS_MANTISBT_PROJECT=\"CentOS-7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT=\"centos\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n```",
  "closed_by": {
    "login": "thatlittleboy",
    "id": 30731072,
    "node_id": "MDQ6VXNlcjMwNzMxMDcy",
    "avatar_url": "https://avatars.githubusercontent.com/u/30731072?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thatlittleboy",
    "html_url": "https://github.com/thatlittleboy",
    "followers_url": "https://api.github.com/users/thatlittleboy/followers",
    "following_url": "https://api.github.com/users/thatlittleboy/following{/other_user}",
    "gists_url": "https://api.github.com/users/thatlittleboy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thatlittleboy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thatlittleboy/subscriptions",
    "organizations_url": "https://api.github.com/users/thatlittleboy/orgs",
    "repos_url": "https://api.github.com/users/thatlittleboy/repos",
    "events_url": "https://api.github.com/users/thatlittleboy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thatlittleboy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1743/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1743/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
