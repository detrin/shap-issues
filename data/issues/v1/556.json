{
  "url": "https://api.github.com/repos/shap/shap/issues/556",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/556/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/556/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/556/events",
  "html_url": "https://github.com/shap/shap/issues/556",
  "id": 434916465,
  "node_id": "MDU6SXNzdWU0MzQ5MTY0NjU=",
  "number": 556,
  "title": "ExtraTrees issue",
  "user": {
    "login": "CanML",
    "id": 35773945,
    "node_id": "MDQ6VXNlcjM1NzczOTQ1",
    "avatar_url": "https://avatars.githubusercontent.com/u/35773945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CanML",
    "html_url": "https://github.com/CanML",
    "followers_url": "https://api.github.com/users/CanML/followers",
    "following_url": "https://api.github.com/users/CanML/following{/other_user}",
    "gists_url": "https://api.github.com/users/CanML/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CanML/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CanML/subscriptions",
    "organizations_url": "https://api.github.com/users/CanML/orgs",
    "repos_url": "https://api.github.com/users/CanML/repos",
    "events_url": "https://api.github.com/users/CanML/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CanML/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2019-04-18T19:08:59Z",
  "updated_at": "2019-04-19T15:59:25Z",
  "closed_at": "2019-04-19T15:59:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "When looking at SHAP force plots, I noticed that when I use an ExtraTrees (sklearn) model, the \"predicted value\" on the force plot is simply the actual target value in my training set. When I use any other tree-based model (sklearn random forest or any GBT model from sklearn, LGBM, XGB, CatBoost, etc.), the force plot will correctly show the model's predicted value rather than the true target (y) value.\r\n\r\nI have used this library quite extensively and successfully but until now hadn't tried it with ExtraTrees and this is the first issue of any kind I've run across.\r\n\r\nThe only single line of code I change between runs to change my model type is this:\r\nmodel = RandomForestRegressor(n_estimators=200, random_state=1234)\r\n        #model = ExtraTreesRegressor(n_estimators=200, random_state=1234)\r\n        #model = LGBMRegressor(n_estimators=200, random_state=1234)\r\n\r\n(uncommenting one of the three lines to select the model type I want to use)\r\n\r\nAll models show a very similar CV MSE fitness.\r\n\r\nIn every case when ExtraTreesRegressor is used, the SHAP values on the force plots appear to be based on the true target values, and the \"predicted value\" shown on each force plot is the actual target value for every single row in the dataset. In every case when any other model type is used, the force plots work as expected.\r\n\r\nI would guess that ExtraTrees falls under the realm of TreeExplainer and that's what I'm using to generate the SHAP values:\r\n\r\nexplainer = shap.TreeExplainer(model)\r\nshap_values = explainer.shap_values(X_train)\r\n\r\nI didn't notice any existing issues here mentioning ExtraTrees. Has anyone else had a similar experience?\r\n",
  "closed_by": {
    "login": "CanML",
    "id": 35773945,
    "node_id": "MDQ6VXNlcjM1NzczOTQ1",
    "avatar_url": "https://avatars.githubusercontent.com/u/35773945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CanML",
    "html_url": "https://github.com/CanML",
    "followers_url": "https://api.github.com/users/CanML/followers",
    "following_url": "https://api.github.com/users/CanML/following{/other_user}",
    "gists_url": "https://api.github.com/users/CanML/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CanML/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CanML/subscriptions",
    "organizations_url": "https://api.github.com/users/CanML/orgs",
    "repos_url": "https://api.github.com/users/CanML/repos",
    "events_url": "https://api.github.com/users/CanML/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CanML/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/556/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/556/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
