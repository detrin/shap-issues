{
  "url": "https://api.github.com/repos/shap/shap/issues/1424",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1424/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1424/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1424/events",
  "html_url": "https://github.com/shap/shap/issues/1424",
  "id": 699446511,
  "node_id": "MDU6SXNzdWU2OTk0NDY1MTE=",
  "number": 1424,
  "title": "Use SHAP with custom class neural network",
  "user": {
    "login": "Simb94",
    "id": 71140892,
    "node_id": "MDQ6VXNlcjcxMTQwODky",
    "avatar_url": "https://avatars.githubusercontent.com/u/71140892?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Simb94",
    "html_url": "https://github.com/Simb94",
    "followers_url": "https://api.github.com/users/Simb94/followers",
    "following_url": "https://api.github.com/users/Simb94/following{/other_user}",
    "gists_url": "https://api.github.com/users/Simb94/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Simb94/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Simb94/subscriptions",
    "organizations_url": "https://api.github.com/users/Simb94/orgs",
    "repos_url": "https://api.github.com/users/Simb94/repos",
    "events_url": "https://api.github.com/users/Simb94/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Simb94/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-09-11T15:23:55Z",
  "updated_at": "2020-09-15T22:25:33Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello,\r\n\r\nI'm trying to explain the behaviour of a custom neural network using SHAP (the class of the custom neaural network is called foo and have a method predict that have as parameter np.array to masquerade the output).\r\n\r\nThe structure of the neural network is:\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n\r\ninput_1 (InputLayer)            [(None, 72, 57, 34)] 0                                            \r\n__________________________________________________________________________________________________\r\none_hot_encoder (OneHotEncoder) (None, 72, 57, 55)   0           input_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nlearnable_background (Learnable (None, 72, 57, 63)   32832       one_hot_encoder[0][0]            \r\n__________________________________________________________________________________________________\r\nsequential (Sequential)         (None, 72, 57, 512)  32768       learnable_background[0][0]       \r\n__________________________________________________________________________________________________\r\ndense_1 (Dense)                 (None, 72, 57, 1)    513         sequential[0][0]                 \r\n__________________________________________________________________________________________________\r\ninput_2 (InputLayer)            [(None, 72, 57, 1)]  0                                            \r\n__________________________________________________________________________________________________\r\nmultiply (Multiply)             (None, 72, 57, 1)    0           dense_1[0][0]                    \r\n_                                                                                    input_2[0][0]  \r\n\r\nAs u can see this network have 2 input layer (one of the two is connected to the last layer and it is intended to exclude few points from the 57*72).\r\nWith shap 0.36.0 and TF 2.1.0 i have an issue trying to apply the DeepExplainer and KernelExplainer to this model because the neural network is wrapped in a custom container class and DeepExplainer seems not able to recognize the model type\r\n\r\ncode for DeepExplainer:\r\nexplainer = shap.DeepExplainer(model_, [background, target_1])\r\nerror:\r\nAssertionError: <class 'foo'> is not currently a supported model type!\r\n\r\nand i'm not able to use KernelExplainer as well because the method does not want a list as input.\r\n\r\nCode:\r\nexplainer = shap.KernelExplainer(model_.predict, [background, target_1])\r\nerror:\r\nAssertionError: Unknown type passed as data object: <class 'list'>\r\n\r\nCan u help me to solve this problem? Do you need some additional information?\r\n\r\nThanks\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1424/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1424/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
