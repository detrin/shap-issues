{
  "url": "https://api.github.com/repos/shap/shap/issues/964",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/964/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/964/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/964/events",
  "html_url": "https://github.com/shap/shap/issues/964",
  "id": 540534323,
  "node_id": "MDU6SXNzdWU1NDA1MzQzMjM=",
  "number": 964,
  "title": "Unable to run for a Keras wide & deep-type model ",
  "user": {
    "login": "dronshaw",
    "id": 13472493,
    "node_id": "MDQ6VXNlcjEzNDcyNDkz",
    "avatar_url": "https://avatars.githubusercontent.com/u/13472493?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dronshaw",
    "html_url": "https://github.com/dronshaw",
    "followers_url": "https://api.github.com/users/dronshaw/followers",
    "following_url": "https://api.github.com/users/dronshaw/following{/other_user}",
    "gists_url": "https://api.github.com/users/dronshaw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dronshaw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dronshaw/subscriptions",
    "organizations_url": "https://api.github.com/users/dronshaw/orgs",
    "repos_url": "https://api.github.com/users/dronshaw/repos",
    "events_url": "https://api.github.com/users/dronshaw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dronshaw/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 486901330,
      "node_id": "MDU6TGFiZWw0ODY5MDEzMzA=",
      "url": "https://api.github.com/repos/shap/shap/labels/todo",
      "name": "todo",
      "color": "cccccc",
      "default": false,
      "description": "This issue had an outstanding action to take."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-12-19T20:08:52Z",
  "updated_at": "2021-09-21T14:47:27Z",
  "closed_at": "2020-01-08T01:46:11Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- Popular [wide & deep model](https://arxiv.org/pdf/1606.07792.pdf) is the combination of two networks\r\n- Assume the wide network is represented as one entire array, while the deep network contains one or more word embeddings\r\n- Then, the input into a Keras model could be formed like so\r\n```\r\ncombined_model = keras.Model([numeric_wide_input,embed_input_1,embed_input_2,embed_input_3], merged_out)\r\ncombined_model.compile(optimizer = 'adam', loss = 'binary_crossentropy')\r\ncombined_model.fit(x=[x_train,train_embed_1,train_embed_2,train_embed_3], \r\n                                   y = y_train)\r\n# where x_train is of type pd.DataFrame\r\n# where train_embed_1,2,3 are of type numpy.ndarray\r\n```\r\n- A keras network like this (from what I can tell) cannot be used within Shap\r\n```\r\nimport shap\r\n# example data\r\nfoo_train = [x_train[new_numeric_features][1:10],\r\n                                train_pad_dv[1:10],train_pad_prch[1:10],train_pad_div[1:10]]\r\n\r\n# form explainer\r\nexplainer = shap.KernelExplainer(combined_model,data=foo_train)\r\n\r\n# get shap values\r\nshap_values = explainer.shap_values(foo_train)\r\n\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-37-4469b5a632da> in <module>()\r\n      5 \r\n      6 # form explainer\r\n----> 7 explainer = shap.KernelExplainer(combined_model,data=foo_train)\r\n      8 \r\n      9 # get shap values\r\n\r\n~/anaconda3/envs/tensorflow_p36/lib/python3.6/site-packages/shap/explainers/kernel.py in __init__(self, model, data, link, **kwargs)\r\n     94         self.keep_index = kwargs.get(\"keep_index\", False)\r\n     95         self.keep_index_ordered = kwargs.get(\"keep_index_ordered\", False)\r\n---> 96         self.data = convert_to_data(data, keep_index=self.keep_index)\r\n     97         model_null = match_model_to_data(self.model, self.data)\r\n     98 \r\n\r\n~/anaconda3/envs/tensorflow_p36/lib/python3.6/site-packages/shap/common.py in convert_to_data(val, keep_index)\r\n    176         return SparseData(val)\r\n    177     else:\r\n--> 178         assert False, \"Unknown type passed as data object: \"+str(type(val))\r\n    179 \r\n    180 class Link:\r\n\r\nAssertionError: Unknown type passed as data object: <class 'list'>\r\n```\r\n- Obviously due to the fact that the input data is not in an expected dataframe but is several arrays. ",
  "closed_by": {
    "login": "dronshaw",
    "id": 13472493,
    "node_id": "MDQ6VXNlcjEzNDcyNDkz",
    "avatar_url": "https://avatars.githubusercontent.com/u/13472493?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dronshaw",
    "html_url": "https://github.com/dronshaw",
    "followers_url": "https://api.github.com/users/dronshaw/followers",
    "following_url": "https://api.github.com/users/dronshaw/following{/other_user}",
    "gists_url": "https://api.github.com/users/dronshaw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dronshaw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dronshaw/subscriptions",
    "organizations_url": "https://api.github.com/users/dronshaw/orgs",
    "repos_url": "https://api.github.com/users/dronshaw/repos",
    "events_url": "https://api.github.com/users/dronshaw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dronshaw/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/964/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/964/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
