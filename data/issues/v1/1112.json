{
  "url": "https://api.github.com/repos/shap/shap/issues/1112",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1112/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1112/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1112/events",
  "html_url": "https://github.com/shap/shap/issues/1112",
  "id": 584578345,
  "node_id": "MDU6SXNzdWU1ODQ1NzgzNDU=",
  "number": 1112,
  "title": "questionable YearMade vs SalePrice for Kaggle bulldozer dependence plot",
  "user": {
    "login": "parrt",
    "id": 178777,
    "node_id": "MDQ6VXNlcjE3ODc3Nw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/178777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/parrt",
    "html_url": "https://github.com/parrt",
    "followers_url": "https://api.github.com/users/parrt/followers",
    "following_url": "https://api.github.com/users/parrt/following{/other_user}",
    "gists_url": "https://api.github.com/users/parrt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/parrt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/parrt/subscriptions",
    "organizations_url": "https://api.github.com/users/parrt/orgs",
    "repos_url": "https://api.github.com/users/parrt/repos",
    "events_url": "https://api.github.com/users/parrt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/parrt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-03-19T17:28:46Z",
  "updated_at": "2020-03-25T15:57:23Z",
  "closed_at": "2020-03-25T15:57:22Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi Scott!! Heh, I'm trying to compare SHAP to a variety of techniques as I work on my own for partial dependence.  I have a case, with enclosed code/results, that I think does not get the right answer. I'm hoping that I am simply not using SHAP properly.   This is a real data set so impossible to know the true answer, but I think the results from SHAP are implausible.  ALE, for example, shows a plausible result which is that older bulldozers are worth less:\r\n\r\n<img width=\"150\" alt=\"Screen Shot 2020-03-19 at 10 21 29 AM\" src=\"https://user-images.githubusercontent.com/178777/77095672-79258100-69cb-11ea-8f1c-a8b63e7a3e21.png\">\r\n\r\nHere is what `shap.dependence_plot()` shows (with marginal plot on the left):\r\n\r\n<img width=\"330\" alt=\"Screen Shot 2020-03-19 at 10 23 57 AM\" src=\"https://user-images.githubusercontent.com/178777/77095922-d28db000-69cb-11ea-99a2-e2778a74e52d.png\">\r\n\r\nThat partial dependence plot looks pretty random.\r\n\r\nI enclose a small 10k sample of the bulldozer data set and complete file to exhibit this behavior. Here are the most important lines (Bulldozer RF OOB R^2 0.81).\r\n\r\n```python\r\nshap_test_size=300\r\nrf = RandomForestRegressor(n_estimators=150, n_jobs=-1,  max_features=0.9,min_samples_leaf=1, oob_score=True)\r\nrf.fit(X, y)\r\n\r\nexplainer = shap.TreeExplainer(rf, data=shap.sample(X, 100),\r\n                               feature_perturbation='interventional')\r\nshap_values = explainer.shap_values(X.sample(n=shap_test_size),\r\n                                    check_additivity=False)\r\n\r\nshap.dependence_plot(\"YearMade\", shap_values, X.sample(n=shap_test_size),\r\n                     interaction_index=None, ax=axes[1], dot_size=5,\r\n                     show=False, alpha=.5)\r\n```\r\n\r\nI'm hoping that I'm doing something obviously wrong.\r\n\r\n[bulldozer10k.zip](https://github.com/slundberg/shap/files/4356060/bulldozer10k.zip)\r\n",
  "closed_by": {
    "login": "parrt",
    "id": 178777,
    "node_id": "MDQ6VXNlcjE3ODc3Nw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/178777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/parrt",
    "html_url": "https://github.com/parrt",
    "followers_url": "https://api.github.com/users/parrt/followers",
    "following_url": "https://api.github.com/users/parrt/following{/other_user}",
    "gists_url": "https://api.github.com/users/parrt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/parrt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/parrt/subscriptions",
    "organizations_url": "https://api.github.com/users/parrt/orgs",
    "repos_url": "https://api.github.com/users/parrt/repos",
    "events_url": "https://api.github.com/users/parrt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/parrt/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1112/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1112/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
