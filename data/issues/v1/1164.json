{
  "url": "https://api.github.com/repos/shap/shap/issues/1164",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1164/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1164/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1164/events",
  "html_url": "https://github.com/shap/shap/issues/1164",
  "id": 602171464,
  "node_id": "MDU6SXNzdWU2MDIxNzE0NjQ=",
  "number": 1164,
  "title": "'tensorflow.python.framework.ops.EagerTensor' object has no attribute 'mean'",
  "user": {
    "login": "jackaraz",
    "id": 18487906,
    "node_id": "MDQ6VXNlcjE4NDg3OTA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/18487906?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jackaraz",
    "html_url": "https://github.com/jackaraz",
    "followers_url": "https://api.github.com/users/jackaraz/followers",
    "following_url": "https://api.github.com/users/jackaraz/following{/other_user}",
    "gists_url": "https://api.github.com/users/jackaraz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jackaraz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jackaraz/subscriptions",
    "organizations_url": "https://api.github.com/users/jackaraz/orgs",
    "repos_url": "https://api.github.com/users/jackaraz/repos",
    "events_url": "https://api.github.com/users/jackaraz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jackaraz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-04-17T18:58:02Z",
  "updated_at": "2020-12-04T18:03:42Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, guys hope everyone is safe and healthy! I'm trying to get SHAP values from a Keras model where after loading the model and weights, I import the CSV data using pandas then got a slice as follows;\r\n\r\n`background = df_full.iloc[np.array(df_full.index.array)[np.random.choice(df_full.shape[0], 10, replace=False)]]`\r\n`background = background.reset_index(drop=True)`\r\n`explainer = shap.DeepExplainer(model,tf.constant(background.values, dtype=np.float32))`\r\n`X  = df_full.iloc[np.array(df_full.index.array)[np.random.choice(df_full.shape[0], \r\n                                                                 10, replace=False)]]`\r\n`shap_values = explainer.shap_values(tf.constant(X.values, dtype=np.float32))`\r\n\r\nBut I get an error from `shap/explainers/deep/deep_tf.py` L308 saying as follows. \r\n\r\n`'tensorflow.python.framework.ops.EagerTensor' object has no attribute 'mean'`\r\n\r\nIn `deep_tf.py`, I found the corresponding line which was;\r\n\r\n`phis[l][j] = (sample_phis[l][bg_data[l].shape[0]:] * (X[l][j] - bg_data[l])).mean(0)`\r\n\r\nwhere this `.mean(0)` was problematic so I changed it with the following;\r\n\r\n`phis[l][j] = np.mean(sample_phis[l][bg_data[l].shape[0]:] * (X[l][j] - bg_data[l]), axis=0)`\r\n\r\nNow it's working for me but I wanted to ask if I'm doing any mistake here, looks like fine and results are as expected. Would be appreciated if you can shine some light on the matter. \r\n\r\nCheers",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1164/reactions",
    "total_count": 8,
    "+1": 6,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 2
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1164/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
