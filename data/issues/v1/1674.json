{
  "url": "https://api.github.com/repos/shap/shap/issues/1674",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1674/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1674/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1674/events",
  "html_url": "https://github.com/shap/shap/issues/1674",
  "id": 771364673,
  "node_id": "MDU6SXNzdWU3NzEzNjQ2NzM=",
  "number": 1674,
  "title": "Let's de-risk comparisons by not using: a) \"is\" for values and b) [in]equality signs for numbers",
  "user": {
    "login": "mirekphd",
    "id": 36706320,
    "node_id": "MDQ6VXNlcjM2NzA2MzIw",
    "avatar_url": "https://avatars.githubusercontent.com/u/36706320?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mirekphd",
    "html_url": "https://github.com/mirekphd",
    "followers_url": "https://api.github.com/users/mirekphd/followers",
    "following_url": "https://api.github.com/users/mirekphd/following{/other_user}",
    "gists_url": "https://api.github.com/users/mirekphd/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mirekphd/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mirekphd/subscriptions",
    "organizations_url": "https://api.github.com/users/mirekphd/orgs",
    "repos_url": "https://api.github.com/users/mirekphd/repos",
    "events_url": "https://api.github.com/users/mirekphd/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mirekphd/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2020-12-19T11:37:52Z",
  "updated_at": "2020-12-19T11:37:52Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "During `shap` compilation from source (for GPU) python 3.8 issues multiple warnings caused by using `is` to compare values (strings and numbers) rather than entire objects (identity). Such [value comparisons with `is` are not recommended](https://realpython.com/python-is-identity-vs-equality/) and in python 3.8 [give `SyntaxWarning`](https://realpython.com/lessons/warnings-about-dangerous-syntax/).\r\n\r\nFor strings I'd just follow language parser's recommendations, but as for floating point numbers, I'd almost never risk using standard [in]equality sign comparisons... One possible replacement for [in]equality sign comparisons for numbers is `math.isclose` :\r\n```\r\n>>> math.isclose(1e-15, 0.0, abs_tol=1e-16)\r\nFalse\r\n\r\n>>> math.isclose(1e-17, 0.0, abs_tol=1e-16)\r\nTrue\r\n```\r\n\r\nAnd here is the list of problematic comparisons from our logs:\r\n\r\n```\r\n12:09:43  Using /opt/conda/lib/python3.8/site-packages\r\n12:09:43  Finished processing dependencies for shap==0.37.0\r\n12:09:43  \u001B[91mbuild/bdist.linux-x86_64/egg/shap/plots/_force_matplotlib.py:119: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n12:09:43    if text_rotation is not 0:\r\n12:09:43  build/bdist.linux-x86_64/egg/shap/plots/_decision.py:429: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n12:09:43    elif feature_order is \"importance\":\r\n12:09:43  build/bdist.linux-x86_64/egg/shap/plots/_decision.py:431: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n12:09:43    elif feature_order is \"hclust\":\r\n12:09:43  build/bdist.linux-x86_64/egg/shap/explainers/_additive.py:85: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n12:09:43    if model.interactions is not 0:\r\n12:09:43  /opt/conda/lib/python3.8/site-packages/shap-0.37.0-py3.8-linux-x86_64.egg/shap/explainers/_additive.py:85: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n12:09:43    if model.interactions is not 0:\r\n12:09:43  /opt/conda/lib/python3.8/site-packages/shap-0.37.0-py3.8-linux-x86_64.egg/shap/plots/_decision.py:429: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n12:09:43    elif feature_order is \"importance\":\r\n12:09:43  /opt/conda/lib/python3.8/site-packages/shap-0.37.0-py3.8-linux-x86_64.egg/shap/plots/_decision.py:431: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n12:09:43    elif feature_order is \"hclust\":\r\n12:09:43  /opt/conda/lib/python3.8/site-packages/shap-0.37.0-py3.8-linux-x86_64.egg/shap/plots/_force_matplotlib.py:119: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n12:09:43    if text_rotation is not 0:\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1674/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1674/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
