{
  "url": "https://api.github.com/repos/shap/shap/issues/601",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/601/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/601/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/601/events",
  "html_url": "https://github.com/shap/shap/issues/601",
  "id": 445779935,
  "node_id": "MDU6SXNzdWU0NDU3Nzk5MzU=",
  "number": 601,
  "title": "summary_plot can't show all the bars",
  "user": {
    "login": "yeqing97",
    "id": 44990275,
    "node_id": "MDQ6VXNlcjQ0OTkwMjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/44990275?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yeqing97",
    "html_url": "https://github.com/yeqing97",
    "followers_url": "https://api.github.com/users/yeqing97/followers",
    "following_url": "https://api.github.com/users/yeqing97/following{/other_user}",
    "gists_url": "https://api.github.com/users/yeqing97/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yeqing97/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yeqing97/subscriptions",
    "organizations_url": "https://api.github.com/users/yeqing97/orgs",
    "repos_url": "https://api.github.com/users/yeqing97/repos",
    "events_url": "https://api.github.com/users/yeqing97/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yeqing97/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2019-05-19T04:47:37Z",
  "updated_at": "2023-06-22T17:06:50Z",
  "closed_at": "2023-06-22T17:06:50Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "![xgb_bar](https://user-images.githubusercontent.com/44990275/57977874-eaa34480-7a33-11e9-96c1-2754773b65f1.jpeg)\r\nI don't know why there are always 8 bars can't be show\r\nThis is my code.\r\nimport numpy as np\r\nimport pandas as pd\r\nimport matplotlib \r\nmatplotlib.use('TkAgg')\r\nimport shap\r\nshap.initjs()\r\n\r\nimport xgboost as xgb\r\nfrom sklearn.model_selection import cross_val_score\r\nfrom sklearn import preprocessing\r\nfrom sklearn import metrics\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.neural_network import MLPClassifier\r\nfrom sklearn.model_selection import StratifiedShuffleSplit\r\n\r\nfrom sklearn.metrics import accuracy_score\r\nfrom sklearn.metrics import cohen_kappa_score\r\nfrom sklearn.metrics import classification_report\r\nfrom sklearn.metrics import confusion_matrix\r\n\r\ntrain = pd.read_csv('/Users/yeqing/Documents/Fingerprint/Pubchem/g1_Pubchem.csv')\r\ntest = pd.read_csv('/Users/yeqing/Documents/Fingerprint/Pubchem/g3_Pubchem.csv')\r\ntrain_data = train.values\r\ntrain_x = train_data[:,1:1201]\r\ntrain_y = train_data[:,0]\r\ntest_data =test.values\r\ntest_x = test_data[:,1:1201]\r\ntest_y = test_data[:,0]\r\ntrain_x[np.isnan(train_x)] = np.mean(train_x[~np.isnan(train_x)])\r\ntest_x[np.isnan(test_x)] = np.mean(test_x[~np.isnan(test_x)])\r\ntrain_x_scaled = preprocessing.scale(train_x)\r\ntest_x_scaled = preprocessing.scale(test_x)\r\n\r\nparams = {\r\n    'eta':0.03,\r\n\t'max_depth':14,\r\n\t'gamma':0.0360,\r\n\t'subsample':0.87,\r\n\t'scale_pos_weight':0.58,\r\n\t'min_child_weight':1,\r\n\t'max_delta_step':0,\r\n\t'alpha':0.0829,\r\n\t'lambda':0.2394,\r\n\t'objective':\"binary:logitraw\"\r\n}\r\n\r\ntrain_x, valid_x, y_train, y_valid = train_test_split(train_x_scaled, train_y, test_size=0.3,stratify=train_y)\r\ndtrain = xgb.DMatrix(train_x, label=y_train)\r\ndvalid = xgb.DMatrix(valid_x, label=y_valid)\r\nnum_round = 100\r\nevals_result = {}\r\nbst = xgb.train(params,\r\n                dtrain,num_boost_round=100,\r\n                evals=[(dtest,'eval'),(dtrain,'train')],\r\n                early_stopping_rounds=5,\r\n\t\t\t\tverbose_eval=20)\r\n\r\ntitle = train.columns[1:1201]\r\ndf_trainx = pd.DataFrame(train_x_scaled,columns=title)\r\n\r\nshap_values = shap.TreeExplainer(bst).shap_values(df_trainx)\r\nshap.summary_plot(shap_values, df_trainx)\r\nshap.summary_plot(shap_values,df_trainx,plot_type=\"bar\")\r\n",
  "closed_by": {
    "login": "thatlittleboy",
    "id": 30731072,
    "node_id": "MDQ6VXNlcjMwNzMxMDcy",
    "avatar_url": "https://avatars.githubusercontent.com/u/30731072?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thatlittleboy",
    "html_url": "https://github.com/thatlittleboy",
    "followers_url": "https://api.github.com/users/thatlittleboy/followers",
    "following_url": "https://api.github.com/users/thatlittleboy/following{/other_user}",
    "gists_url": "https://api.github.com/users/thatlittleboy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thatlittleboy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thatlittleboy/subscriptions",
    "organizations_url": "https://api.github.com/users/thatlittleboy/orgs",
    "repos_url": "https://api.github.com/users/thatlittleboy/repos",
    "events_url": "https://api.github.com/users/thatlittleboy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thatlittleboy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/601/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/601/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
