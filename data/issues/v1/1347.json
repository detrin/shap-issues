{
  "url": "https://api.github.com/repos/shap/shap/issues/1347",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1347/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1347/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1347/events",
  "html_url": "https://github.com/shap/shap/issues/1347",
  "id": 673537294,
  "node_id": "MDU6SXNzdWU2NzM1MzcyOTQ=",
  "number": 1347,
  "title": "Can't run genomics example",
  "user": {
    "login": "f6v",
    "id": 13019221,
    "node_id": "MDQ6VXNlcjEzMDE5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/13019221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/f6v",
    "html_url": "https://github.com/f6v",
    "followers_url": "https://api.github.com/users/f6v/followers",
    "following_url": "https://api.github.com/users/f6v/following{/other_user}",
    "gists_url": "https://api.github.com/users/f6v/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/f6v/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/f6v/subscriptions",
    "organizations_url": "https://api.github.com/users/f6v/orgs",
    "repos_url": "https://api.github.com/users/f6v/repos",
    "events_url": "https://api.github.com/users/f6v/events{/privacy}",
    "received_events_url": "https://api.github.com/users/f6v/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-08-05T13:24:24Z",
  "updated_at": "2022-06-15T14:15:44Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Running `DeepExplainer`  example with genomics data results in following:\r\n\r\n> TypeError                                 Traceback (most recent call last)\r\n> <ipython-input-9-1ac975dbed95> in <module>()\r\n>      14 seqs_to_explain = onehot_data[[0,3,9]] #these three are positive for task 0\r\n>      15 dinuc_shuff_explainer = shap.DeepExplainer((keras_model.input, keras_model.output[:,0]), shuffle_several_times)\r\n> ---> 16 raw_shap_explanations = dinuc_shuff_explainer.shap_values(seqs_to_explain)\r\n>      17 \r\n>      18 #project the importance at each position onto the base that's actually present\r\n> \r\n> 1 frames\r\n> /usr/local/lib/python3.6/dist-packages/shap/explainers/deep/deep_tf.py in shap_values(self, X, ranked_outputs, output_rank_order, check_additivity)\r\n>     316             else:\r\n>     317                 model_output = self.model(X)\r\n> --> 318             for l in range(len(self.expected_value)):\r\n>     319                 if not self.multi_input:\r\n>     320                     diffs = model_output[:, l] - self.expected_value[l] - output_phis[l].sum(axis=tuple(range(1, output_phis[l].ndim)))\r\n> \r\n> TypeError: object of type 'NoneType' has no len()\r\n\r\nI'm having this issue on Colab with tf 1.15.2 and on Jupyter with tf 1.13.1 and Python 3.6.6.\r\nWith tf 2.3.0 on Colab there's different issue:\r\n\r\n> NameError                                 Traceback (most recent call last)\r\n> <ipython-input-9-1ac975dbed95> in <module>()\r\n>      13 \r\n>      14 seqs_to_explain = onehot_data[[0,3,9]] #these three are positive for task 0\r\n> ---> 15 dinuc_shuff_explainer = shap.DeepExplainer((keras_model.input, keras_model.output[:,0]), shuffle_several_times)\r\n>      16 raw_shap_explanations = dinuc_shuff_explainer.shap_values(seqs_to_explain)\r\n>      17 \r\n> \r\n> 1 frames\r\n> /usr/local/lib/python3.6/dist-packages/shap/explainers/deep/deep_tf.py in __init__(self, model, data, session, learning_phase_flags)\r\n>     105             if type(model) is tuple or type(model) is list:\r\n>     106                 assert len(model) == 2, \"When a tuple is passed it must be of the form (inputs, outputs)\"\r\n> --> 107                 self.model = Model(model[0], model[1])\r\n>     108             else:\r\n>     109                 self.model = model\r\n> \r\n> NameError: name 'Model' is not defined\r\n\r\nWould appreciate any tips!",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1347/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1347/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
