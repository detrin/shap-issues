{
  "url": "https://api.github.com/repos/shap/shap/issues/96",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/96/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/96/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/96/events",
  "html_url": "https://github.com/shap/shap/issues/96",
  "id": 325133443,
  "node_id": "MDU6SXNzdWUzMjUxMzM0NDM=",
  "number": 96,
  "title": "name '_cext' is not defined",
  "user": {
    "login": "gschivley",
    "id": 10373332,
    "node_id": "MDQ6VXNlcjEwMzczMzMy",
    "avatar_url": "https://avatars.githubusercontent.com/u/10373332?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gschivley",
    "html_url": "https://github.com/gschivley",
    "followers_url": "https://api.github.com/users/gschivley/followers",
    "following_url": "https://api.github.com/users/gschivley/following{/other_user}",
    "gists_url": "https://api.github.com/users/gschivley/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gschivley/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gschivley/subscriptions",
    "organizations_url": "https://api.github.com/users/gschivley/orgs",
    "repos_url": "https://api.github.com/users/gschivley/repos",
    "events_url": "https://api.github.com/users/gschivley/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gschivley/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 21,
  "created_at": "2018-05-22T04:02:36Z",
  "updated_at": "2023-07-22T08:21:34Z",
  "closed_at": "2023-07-22T08:21:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I just installed shap 0.16.1 in a conda environment using pip. Trying to use it on a sklearn RandomForestRegressor model gave me the following error:\r\n\r\n```Python\r\nshap_values = shap.TreeExplainer(rf_reg).shap_values(X_train)\r\n```\r\n```\r\nNameError                                 Traceback (most recent call last)\r\n<ipython-input-191-e0ae3457ffe4> in <module>()\r\n----> 1 shap_values = shap.TreeExplainer(rf_reg)#.shap_values(X_train)\r\n\r\n~/anaconda/envs/marginal_emiss/lib/python3.6/site-packages/shap/explainers/tree.py in __init__(self, model, **kwargs)\r\n     41 \r\n     42         if str(type(model)).endswith(\"sklearn.ensemble.forest.RandomForestRegressor'>\"):\r\n---> 43             self.trees = [Tree(e.tree_) for e in model.estimators_]\r\n     44         elif str(type(model)).endswith(\"sklearn.tree.tree.DecisionTreeRegressor'>\"):\r\n     45             self.trees = [Tree(model.tree_)]\r\n\r\n~/anaconda/envs/marginal_emiss/lib/python3.6/site-packages/shap/explainers/tree.py in <listcomp>(.0)\r\n     41 \r\n     42         if str(type(model)).endswith(\"sklearn.ensemble.forest.RandomForestRegressor'>\"):\r\n---> 43             self.trees = [Tree(e.tree_) for e in model.estimators_]\r\n     44         elif str(type(model)).endswith(\"sklearn.tree.tree.DecisionTreeRegressor'>\"):\r\n     45             self.trees = [Tree(model.tree_)]\r\n\r\n~/anaconda/envs/marginal_emiss/lib/python3.6/site-packages/shap/explainers/tree.py in __init__(self, tree, normalize)\r\n    187 \r\n    188             # we compute the expectations to make sure they follow the SHAP logic\r\n--> 189             self.max_depth = _cext.compute_expectations(\r\n    190                 self.children_left, self.children_right, self.node_sample_weight,\r\n    191                 self.values\r\n\r\nNameError: name '_cext' is not defined\r\n```\r\n\r\nOn further inspection, looks like there's an ImportError. The code in Tree.py seems to suppress ImportErrors. When I comment out the `except ImportError:` portion I do get the printed error.\r\n\r\n```Python\r\ntry:\r\n    from .. import _cext\r\nexcept ImportError:\r\n    pass\r\nexcept:\r\n    print(\"the C extension is installed...but failed to load!\")\r\n    pass\r\n```\r\n\r\n\r\nFirst attempt at installation gave some errors because cython wasn't installed. I uninstalled shap, installed cython from conda, and reinstalled shap with pip. ",
  "closed_by": {
    "login": "thatlittleboy",
    "id": 30731072,
    "node_id": "MDQ6VXNlcjMwNzMxMDcy",
    "avatar_url": "https://avatars.githubusercontent.com/u/30731072?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thatlittleboy",
    "html_url": "https://github.com/thatlittleboy",
    "followers_url": "https://api.github.com/users/thatlittleboy/followers",
    "following_url": "https://api.github.com/users/thatlittleboy/following{/other_user}",
    "gists_url": "https://api.github.com/users/thatlittleboy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thatlittleboy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thatlittleboy/subscriptions",
    "organizations_url": "https://api.github.com/users/thatlittleboy/orgs",
    "repos_url": "https://api.github.com/users/thatlittleboy/repos",
    "events_url": "https://api.github.com/users/thatlittleboy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thatlittleboy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/96/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/96/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
