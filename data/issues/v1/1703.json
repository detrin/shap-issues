{
  "url": "https://api.github.com/repos/shap/shap/issues/1703",
  "repository_url": "https://api.github.com/repos/shap/shap",
  "labels_url": "https://api.github.com/repos/shap/shap/issues/1703/labels{/name}",
  "comments_url": "https://api.github.com/repos/shap/shap/issues/1703/comments",
  "events_url": "https://api.github.com/repos/shap/shap/issues/1703/events",
  "html_url": "https://github.com/shap/shap/issues/1703",
  "id": 776062874,
  "node_id": "MDU6SXNzdWU3NzYwNjI4NzQ=",
  "number": 1703,
  "title": "Problem with a fastai model (RuntimeError: hook 'deeplift_grad' has changed the size of value)",
  "user": {
    "login": "CosmicHunter",
    "id": 52317137,
    "node_id": "MDQ6VXNlcjUyMzE3MTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/52317137?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CosmicHunter",
    "html_url": "https://github.com/CosmicHunter",
    "followers_url": "https://api.github.com/users/CosmicHunter/followers",
    "following_url": "https://api.github.com/users/CosmicHunter/following{/other_user}",
    "gists_url": "https://api.github.com/users/CosmicHunter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CosmicHunter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CosmicHunter/subscriptions",
    "organizations_url": "https://api.github.com/users/CosmicHunter/orgs",
    "repos_url": "https://api.github.com/users/CosmicHunter/repos",
    "events_url": "https://api.github.com/users/CosmicHunter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CosmicHunter/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2020-12-29T20:01:09Z",
  "updated_at": "2020-12-29T20:01:09Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Implemented a simple image classification model in fastai  using the resnet18 architecture. \r\nlearner in fastai\r\n``` \r\nlearn = Learner(dls, arch, loss_func=CrossEntropyLossFlat(), metrics=[accuracy, f1score],\r\n                                opt_func=ranger,\r\n                                 cbs=[EarlyStoppingCallback(patience = 10, monitor = 'f1_score'),\r\n                                     SaveModelCallback(fname='cat_vs_dog_rs18',\r\n                                                      monitor='f1_score',\r\n                                                      reset_on_fit = False), \r\n                                     ReduceLROnPlateau()])\r\n```\r\n>e = shap.DeepExplainer(learn.model, background)\r\n> shap_values = e.shap_values(test_images)\r\n\r\nThe below errors and warnings appear\r\n``` \r\nWarning: unrecognized nn.Module: Flatten\r\nWarning: unrecognized nn.Module: AdaptiveMaxPool2d\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-63-c68d6304d8ee> in <module>()\r\n----> 1 shap_values = e.shap_values(test_images)\r\n\r\n7 frames\r\n/usr/local/lib/python3.6/dist-packages/torch/autograd/__init__.py in grad(outputs, inputs, grad_outputs, retain_graph, create_graph, only_inputs, allow_unused)\r\n    202     return Variable._execution_engine.run_backward(\r\n    203         outputs, grad_outputs_, retain_graph, create_graph,\r\n--> 204         inputs, allow_unused)\r\n    205 \r\n    206 \r\n\r\nRuntimeError: hook 'deeplift_grad' has changed the size of the value\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/shap/shap/issues/1703/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/shap/shap/issues/1703/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
